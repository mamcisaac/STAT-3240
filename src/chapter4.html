<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Chapter 4</title>
    <meta charset="utf-8" />
    <meta name="author" content="Michael McIsaac" />
    <script src="chapter4_files/header-attrs/header-attrs.js"></script>
    <script src="chapter4_files/htmlwidgets/htmlwidgets.js"></script>
    <link href="chapter4_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="chapter4_files/datatables-binding/datatables.js"></script>
    <script src="chapter4_files/jquery/jquery-3.6.0.min.js"></script>
    <link href="chapter4_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="chapter4_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="chapter4_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="chapter4_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="chapter4_files/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Chapter 4
]
.subtitle[
## STAT 3240
]
.author[
### Michael McIsaac
]
.institute[
### UPEI
]

---












### 4: Simultaneous Inferences and Other Topics in Regression Analysis

### Learning Objectives for Sections 4.1-4.3 

After Sections 4.1-4.3, you should be able to 

- Compute and interpret Bonferroni and Working-Hotelling simultaneous CIs
- Compute and interpret simultaneous prediction intervals
	
	
---

### 4.1 Joint Estimation of `\(\beta_0\)` and `\(\beta_1\)`

A procedure that provides a family confidence coefficient when estimating both `\(\beta_0\)` and `\(\beta_1\)` is often highly desirable since it permits the analyst to weave the two separate results together into an integrated set of conclusions, with an assurance that the entire set of estimates is correct. 

---

### Bonferroni Joint Confidence Intervals

One procedure for constructing simultaneous confidence intervals for `\(\beta_0\)` and `\(\beta_1\)` with a specified family confidence coefficient is the Bonferroni procedure:

`$$\boxed{b_0 \pm t(1-(\alpha/2)/2; n-2)s \{ b_0 \}  }.$$`
`$$\boxed{b_1 \pm t(1-(\alpha/2)/2; n-2)s \{ b_1 \}  }.$$`

I.e., we use the usual CIs, but at a level of `\(1-\alpha/2\)`, so that together we have at least a simultaneous confidence of `\(1-\alpha\)`.

--

We reiterate that the Bonferroni `\(1-\alpha\)` family confidence coefficient is actually a lower bound on the true (but often unknown) family confidence coefficient. 

To the extent that incorrect interval estimates of `\(\beta_0\)` and `\(\beta_1\)` tend to pair up in the family, the families of statements will tend to be correct more than `\((1-\alpha) 100\)` percent of the time. 

---

### 4.2 Simultaneous Estimation of Mean Responses


Often the mean responses at a number of `\(X\)` levels need to be estimated from the same sample data.

The combination of sampling errors in `\(b_0\)` and `\(b_1\)` may be such that the interval estimates of `\(E[Y_h]\)` will be correct over some range of `\(X\)` levels and incorrect elsewhere.


---

### Working-Hotelling Procedure

The Working-Hotelling procedure is based on the confidence band for the regression line discussed in Section 2.6. 


The *confidence band* contains the entire regression line and therefore contains the mean responses at all `\(X\)` levels. Hence, we can use the boundary values of the confidence band at selected `\(X\)` levels as simultaneous estimates of the mean responses at these `\(X\)` levels. 

The family confidence coefficient for these simultaneous estimates will be at least `\(1-\alpha\)` because the confidence coefficient that the entire confidence band for the regression line is correct is `\(1-\alpha\)`.

`$$\boxed{\hat{Y}_h \pm \sqrt{2 F(1-\alpha; 2; n-2)} s \{ \hat{Y}_h \}  }$$`

---

### Bonferroni Procedure

The Bonferroni procedure, discussed earlier for simultaneous estimation of `\(\beta_0\)` and `\(\beta_1\)` is a completely general procedure. 

To construct a family of confidence intervals for mean responses at `\(g\)` different `\(X\)` levels with this procedure with family confidence coefficient `\(1-\alpha\)`, we use  

`$$\boxed{\hat{Y}_h \pm t(1-(\alpha/2)/g; n-2) s \{ \hat{Y}_h \}  }$$`

---

For larger families, the Working-Hotelling confidence limits will always be the tighter, since `\(\sqrt{2 F(1-\alpha; 2; n-2)}\)` stays the same for any number of statements in the family,  whereas `\(t(1-(\alpha/2)/g; n-2)\)` becomes larger as the number of statements increases. 

In practice, once the family confidence coefficient has been decided upon, one can calculate both of these terms to determine which procedure leads to tighter confidence limits.

Note that both the Working-Hotelling and Bonferroni procedures provide lower bounds to the actual family confidence coefficient.

---
layout: true
class: inverse

---

### SHS: Simultaneous Estimation


The Canadian Survey of Household Spending is carried out annually across Canada. 

(http://dli-idd-nesstar.statcan.gc.ca.proxy.library.upei.ca/webview/) 

The main purpose of the survey is to obtain detailed information about household spending. Information is also collected about dwelling characteristics as well as household equipment. 

The survey data are used by the following groups:

* Government departments use the data to help formulate policy; 
* Community groups, social agencies and consumer groups use the data to support their positions and to lobby governments for social changes; 
* Lawyers and their clients use the data to determine what is fair for child support and other compensation; 
* Labour and contract negotiators rely on the data when discussing wage and cost-of-living clauses; 
* Individuals and families can use the data to compare their spending habits with those of similar types of households. 

---


```r
###A subset of the latest Survey of Household Spending data are displayed below:
spending_subset %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a41631baecc118d4ccda" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a41631baecc118d4ccda">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL","NL"],["single_detached","single_detached","single_detached","row_house","single_detached","single_detached","single_detached","single_detached","duplex","single_detached","single_detached","single_detached","single_detached","single_detached","duplex","apartment","single_detached","single_detached","apartment","apartment","apartment","apartment","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached","single_detached"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000],["never_married","never_married","married","never_married","married","married","other","married","never_married","other","married","never_married","other","other","never_married","never_married","other","married","never_married","other","other","never_married","married","married","married","married","other","other","married","married"],["30-34","25-29","35-39","30-34","25-29","25-29","55-59","55-59","25-29","40-44","50-54","25-29","50-54","50-54","&lt;25","&lt;25","50-54","40-44","35-39","40-44","50-54","50-54","55-59","45-49","30-34","25-29","35-39","60-64","25-29","30-34"],["female","male","male","female","female","male","female","male","female","female","female","male","male","female","female","female","female","female","male","male","female","female","female","male","male","male","male","female","female","female"],[3940,7350,5150,6240,4480,10120,3200,10200,2850,6500,5400,5180,8100,6040,3800,2800,8880,10825,4450,9120,4300,4440,8400,9000,4800,3010,6000,3950,8740,4500],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800],[32670,8396,3456,5308,11576,4501,7846,7982,560,6649,12601,6481,24900,2640,2550,5029,8343,8450,4405,9910,8206,22450,6440,10340,7282,4090,150,4622,4751,6062],[1125,1280,1350,1290,490,1870,903,1280,710,1830,760,1530,1140,720,1330,1655,1450,1855,170,766,565,650,635,1690,300,404,135,645,1900,1660],[2637,5247,2610,2300,1410,1360,2480,6980,1240,4185,3947,2028,4680,800,625,5050,5415,7510,4145,2920,1178,1450,1344,3070,5980,2027,1495,2505,4032,1600],[760,620,900,300,1040,20,2816,3212,105,520,560,0,5230,880,4575,1505,300,331,0,2500,2560,288,1200,2900,390,530,369,3660,0,650],[851,740,255,240,480,888,1307,680,90,784,2096,55,200,492,307,1104,748,1499,77,236,182,312,100,260,1200,350,35,363,1402,743],[57695,46271,28466,33029,49198,76120,37661,58537,11970,58871,37931,19970,63855,36752,23702,34688,64441,73373,24589,32152,30660,47712,42323,64010,47847,28819,19928,39992,55650,34505],[75801,61511,43010,38586,71187,96812,46051,85446,13320,77883,65928,26926,84792,46330,27712,48319,85928,99228,38718,40161,48232,59347,65330,97759,80193,40914,25856,66920,96494,55567],[52,52,52,26,52,52,39,52,52,52,52,52,52,52,52,52,52,48,52,52,52,42,52,42,52,22,52,43,44,40]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province<\/th>\n      <th>type_of_dwelling<\/th>\n      <th>income<\/th>\n      <th>marital_status<\/th>\n      <th>age_group<\/th>\n      <th>sex<\/th>\n      <th>food_expenditure<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>transportation_expenditure<\/th>\n      <th>personal_care_expenditure<\/th>\n      <th>recreation_expenditure<\/th>\n      <th>tobacco_alcohol_expenditure<\/th>\n      <th>miscellaneous_expenditure<\/th>\n      <th>total_consumption_expenditure<\/th>\n      <th>total_expenditure<\/th>\n      <th>weeks_worked<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[3,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

We are interested in the potential relationship between the income of working Canadians and the amount that they spend on clothing in a year.


---

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:
 

```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-2-1.png" width="504" style="display: block; margin: auto;" /&gt;

---
 

```r
clothing_model = lm(clothing_expenditure~income, data=spending_subset)
confint(clothing_model, level=.95) %&gt;% round(4)
```

```
##                 2.5 %    97.5 %
## (Intercept) -540.5721 2667.9468
## income        -0.0033    0.0643
```

```r
confint(clothing_model, level=.975) %&gt;% round(4)
```

```
##                1.25 %   98.75 %
## (Intercept) -791.2228 2918.5975
## income        -0.0086    0.0696
```

--

* **Interpret the confidence intervals in your own words.**

--

Notice that the `\([1-(\alpha/2)] \cdot 100\)` percentile of the `\(t\)`-distribution is used in order to get a confidence level of `\(1-\alpha\)`. 


Similarly the `\([1-(\alpha/2)/2] \cdot 100\)` percentile of the `\(t\)`-distribution is used in order to get a joint confidence level of `\(1-(\alpha/2)\)`. 

---

A family of *confidence intervals* for simultaneous estimation of `\(E[Y_h]\)` corresponding to `\(X_h =\)` 40000, 50000, and 60000 can be found using the following code in `R`:

```r
bonf_ci=predict(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), interval="confidence", level=1-0.1/3); bonf_ci
```

```
##        fit      lwr      upr
## 1 2283.546 1590.178 2976.915
## 2 2588.511 1870.635 3306.388
## 3 2893.476 1986.288 3800.664
```

```r
WH_ci=ALSM::ci.reg(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="w"); WH_ci
```

```
##   income      Fit Lower.Band Upper.Band
## 1  40000 2283.546   1590.491   2976.602
## 2  50000 2588.511   1870.958   3306.064
## 3  60000 2893.476   1986.698   3800.254
```

---


```r
B = qt(1-0.1/(2*3), clothing_model$df.residual); B
```

```
## [1] 2.238312
```

```r
W = sqrt(2* qf(1-.1, 2, clothing_model$df.residual)); W
```

```
## [1] 2.237302
```

---

* **Interpret the confidence intervals in your own words.**

&lt;!-- PUT SELECT WARM UP RESPONSES HEREHERE (preceded by a "&gt;"): --&gt;
&lt;!-- warm up question 4) 1 --&gt;



---
layout: false

### 4.3: Simultaneous Prediction Intervals for New Observations

Two procedures for making simultaneous predictions will be considered here: the Scheffe and Bonferroni procedures. Both utilize the same type of limits as those for predicting a single observation, and only the multiple of the estimated standard deviation is changed. 

The Scheffe procedure uses the `\(F\)` distribution, whereas the Bonferroni procedure uses the `\(t\)` distribution. 

The simultaneous prediction limits for `\(g\)` predictions with the Scheffe procedure with family confidence coefficient `\(1 - \alpha\)` are:

`$$\hat Y_h \pm S \cdot s\{pred\},$$`
where `\(S^2= g \cdot F(1 - \alpha; g, n-2)\)`. 

The Bonferroni procedure uses
`$$\hat Y_h \pm B \cdot s\{pred\},$$`
where `\(B= t(1 - (\alpha/2)/g; n-2)\)`.

---

The `\(S\)` and `\(B\)` multiples can be evaluated in advance to see which procedure provides tighter prediction limits.

Note that both the `\(B\)` and `\(S\)` multiples for simultaneous predictions become larger as `\(g\)` increases. 

This contrasts with simultaneous estimation of mean responses where the `\(B\)` multiple becomes larger but not the `\(W\)` (Working-Hotelling) multiple. 

When `\(g\)` is large, both the `\(B\)` and `\(S\)` multiples for simultaneous predictions may become so large that the prediction intervals will be too wide to be useful. 

Other simultaneous estimation techniques might then be considered, as discussed in Reference 4.1.


---
layout: true
class: inverse

---

### SHS: Simultaneous Prediction

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:
 

```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-6-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

A family of *prediction intervals* for simultaneous prediction of `\(Y_h\)`:


```r
bonf_ci = predict(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), interval="predict", level=1-0.1/3); bonf_ci
```

```
##        fit        lwr      upr
## 1 2283.546 -1502.3075 6069.400
## 2 2588.511 -1201.9079 6378.930
## 3 2893.476  -937.3098 6724.262
```

```r
bonf_ci2 = ALSM::ci.reg(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="gn"); bonf_ci2
```

```
##   income      Fit Lower.Band Upper.Band
## 1  40000 2283.546 -1502.3075   6069.400
## 2  50000 2588.511 -1201.9079   6378.930
## 3  60000 2893.476  -937.3098   6724.262
```

```r
  scheffe_ci = ALSM::ci.reg(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="s"); scheffe_ci
```

```
##   income      Fit Lower.Band Upper.Band
## 1  40000 2283.546   -2858509    2863076
## 2  50000 2588.511   -2865107    2870284
## 3  60000 2893.476   -2926208    2931994
```

--

Those `type="s"` intervals do not seem plausible...

---
Let's look at what `ci.reg` is doing when `type="s"`:


```r
ALSM::ci.reg
```

```
## function (model, newdata, type = c("b", "s", "w", "n", "m", "nm", 
##     "gn"), alpha = 0.05, m = 1) 
## {
##     type &lt;- match.arg(type)
##     newdata &lt;- as.data.frame(newdata)
##     if (dim(newdata)[2] == length(names(model$coeff))) {
##         colnames(newdata) &lt;- names(model$coeff)
##     }
##     else {
##         colnames(newdata) &lt;- names(model$coeff)[-1]
##     }
##     CI &lt;- predict(model, newdata, se.fit = T)
##     g &lt;- nrow(newdata)
##     p &lt;- ncol(newdata) + 1
##     syh &lt;- CI$se.fit
##     spred &lt;- sqrt(CI$residual.scale^2 + (CI$se.fit)^2)
##     spredmean &lt;- sqrt((CI$residual.scale^2)/m + (CI$se.fit)^2)
##     b &lt;- qt(1 - alpha/(2 * g), model$df)
##     s &lt;- sqrt(g * qf(1 - alpha, g, model$df))
##     w &lt;- sqrt(p * qf(1 - alpha, p, model$df))
##     if (match.arg(type) == "b") {
##         s &lt;- syh
##         z &lt;- b
##     }
##     else if (match.arg(type) == "s") {
##         s &lt;- spred
##         z &lt;- s
##     }
##     else if (match.arg(type) == "w") {
##         s &lt;- syh
##         z &lt;- w
##     }
##     else if (match.arg(type) == "n") {
##         s &lt;- spred
##         z &lt;- qt(1 - alpha/2, model$df)
##     }
##     else if (match.arg(type) == "nm") {
##         s &lt;- spredmean
##         z &lt;- qt(1 - alpha/2, model$df)
##     }
##     else if (match.arg(type) == "m") {
##         s &lt;- syh
##         z &lt;- qt(1 - alpha/2, model$df)
##     }
##     else if (match.arg(type) == "gn") {
##         s &lt;- spred
##         z &lt;- b
##     }
##     x &lt;- data.frame(newdata, Fit = CI$fit, Lower.Band = CI$fit - 
##         z * s, Upper.Band = CI$fit + z * s)
##     return(x)
## }
## &lt;bytecode: 0x7f7cbbabe358&gt;
## &lt;environment: namespace:ALSM&gt;
```

---


```r
ci.reg_fixed = function (model, newdata, type = c("b", "s", "w", "n", "m", "nm", "gn"), alpha = 0.05, m = 1) 
{
    type &lt;- match.arg(type)
    newdata &lt;- as.data.frame(newdata)
    if (dim(newdata)[2] == length(names(model$coeff))) {
        colnames(newdata) &lt;- names(model$coeff)
    }
    else {
        colnames(newdata) &lt;- names(model$coeff)[-1]
    }
    CI &lt;- predict(model, newdata, se.fit = T)
    g &lt;- nrow(newdata)
    p &lt;- ncol(newdata) + 1
    syh &lt;- CI$se.fit
    spred &lt;- sqrt(CI$residual.scale^2 + (CI$se.fit)^2)
    spredmean &lt;- sqrt((CI$residual.scale^2)/m + (CI$se.fit)^2)
    b &lt;- qt(1 - alpha/(2 * g), model$df)
    s &lt;- sqrt(g * qf(1 - alpha, g, model$df))
    w &lt;- sqrt(p * qf(1 - alpha, p, model$df))
    if (match.arg(type) == "b") {
        s &lt;- syh
        z &lt;- b
    }
    else if (match.arg(type) == "s") {
*        z &lt;- s
*        s &lt;- spred
    }
    else if (match.arg(type) == "w") {
        s &lt;- syh
        z &lt;- w
    }
    else if (match.arg(type) == "n") {
        s &lt;- spred
        z &lt;- qt(1 - alpha/2, model$df)
    }
    else if (match.arg(type) == "nm") {
        s &lt;- spredmean
        z &lt;- qt(1 - alpha/2, model$df)
    }
    else if (match.arg(type) == "m") {
        s &lt;- syh
        z &lt;- qt(1 - alpha/2, model$df)
    }
    else if (match.arg(type) == "gn") {
        s &lt;- spred
        z &lt;- b
    }
    x &lt;- data.frame(newdata, Fit = CI$fit, Lower.Band = CI$fit - z * s, Upper.Band = CI$fit + z * s)
    return(x)
}
```

---
.pull-left[

```r
bonf_ci = predict(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), interval="predict", level=1-0.1/3); bonf_ci
```

```
##        fit        lwr      upr
## 1 2283.546 -1502.3075 6069.400
## 2 2588.511 -1201.9079 6378.930
## 3 2893.476  -937.3098 6724.262
```

```r
scheffe_ci = ALSM::ci.reg(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="s"); scheffe_ci[,c(3,4)]
```

```
##   Lower.Band Upper.Band
## 1   -2858509    2863076
## 2   -2865107    2870284
## 3   -2926208    2931994
```

```r
S = sqrt(3*qf(1-.1, 3, clothing_model$df.residual)); S
```

```
## [1] 2.621409
```

```r
(6717.366- -2150.273) / (6069.400- -1502.3075)
```

```
## [1] 1.171154
```
]

.pull-right[

```r
bonf_ci2 = ALSM::ci.reg(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="gn"); bonf_ci2[,c(3,4)]
```

```
##   Lower.Band Upper.Band
## 1 -1502.3075   6069.400
## 2 -1201.9079   6378.930
## 3  -937.3098   6724.262
```

```r
scheffe_ci = ci.reg_fixed(clothing_model, newdata=data.frame(income=c(40000, 50000, 60000)), alpha=0.1, type="s"); scheffe_ci[,c(3,4)]
```

```
##   Lower.Band Upper.Band
## 1  -2150.273   6717.366
## 2  -1850.655   7027.677
## 3  -1592.965   7379.917
```

```r
B = qt(1-.1/(2*3), clothing_model$df.residual); B
```

```
## [1] 2.238312
```

```r
S/B
```

```
## [1] 1.171154
```
]

---

* **Interpret the prediction intervals in your own words.**

&lt;!-- PUT SELECT WARM UP RESPONSES HEREHERE (preceded by a "&gt;"): --&gt;
&lt;!-- warm up question 4) 2 --&gt;



---

### CDI: Simultaneous CIs and PIs - physicians vs hospital beds

This data set provides selected county demographic information (CDI) for 440 of the most populous counties in the United States. 

Each line of the data set has an identification number with a county name and state abbreviation and provides information on 14 variables for a single county. 

Counties with missing data were deleted from the data set.

---

```r
cdi %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f5fa2d98d210142498dc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f5fa2d98d210142498dc">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440"],["Los_Angeles","Cook","Harris","San_Diego","Orange","Kings","Maricopa","Wayne","Dade","Dallas","Philadelphia","King","Santa_Clara","San_Bernardino","Cuyahoga","Middlesex","Allegheny","Suffolk","Nassau","Alameda","Broward","Bexar","Riverside","Tarrant","Oakland","Sacramento","Hennepin","St._Louis","Erie","Franklin","Milwaukee","Westchester","Hamilton","Palm_Beach","Hartford","Pinellas","Honolulu","Hillsborough","Fairfield","Shelby","Bergen","Fairfax_County","New_Haven","Contra_Costa","Marion","DuPage","Essex","Montgomery","Clark","Baltimore_City","Prince_George's","Salt_Lake","San_Francisco","Macomb","Monroe","Worcester","Baltimore","Montgomery","Orange","Duval","Middlesex","Essex","Ventura","Fresno","Pima","Jefferson","Suffolk","Jefferson","San_Mateo","Fulton","Jackson","Norfolk","District_of_Columbia","Oklahoma","Providence","El_Paso","Pierce","Multnomah","Travis","Montgomery","Monmouth","Hudson","Delaware","De_Kalb","Kern","Bucks","Lake","Summit","Mecklenburg","Davidson","Bristol","Tulsa","Camden","Kent","Orleans","Union","Ramsey","San_Joaquin","Bernalillo","Lake","Onondaga","Denver","Snohomish","Lucas","Hampden","Passaic","Jefferson","Cobb","New_Castle","Jefferson","Plymouth","Ocean","Genesee","Anne_Arundel","Wake","Lancaster","Morris","Douglas","Polk","Sedgwick","Brevard","El_Paso","St._Louis_City","Burlington","VA_Beach_City","Arapahoe","Sonoma","Hidalgo","East_Baton_Rouge","Mobile","Chester","Volusia","Stanislaus","Westmoreland","Santa_Barbara","Stark","Dane","Spokane","Will","Monterey","Johnson","Gwinnett","Pulaski","Guilford","Solano","York","Berks","Hillsborough","Knox","Lee","Luzerne","Mercer","Greenville","Kane","Tulare","Washington","Orange","Waukesha","Allen","Charleston","Albany","Butler","Nueces","Lehigh","Seminole","Richland","Hamilton","Washtenaw","Lane","Ingham","Pasco","Clackamas","Sarasota","Erie","Dakota","Cumberland","Denton","Lorain","Forsyth","Rockland","Adams","Mahoning","Collin","Utah","St._Clair","Escambia","Norfolk_City","Cameron","Dutchess","New_London","Washoe","Hinds","Winnebago","Oneida","Madison","Caddo","Northampton","St._Joseph","Rockingham","Cumberland","Somerset","Jefferson","Madison","Clark","Dauphin","Marin","Gloucester","Santa_Cruz","Marion","Trumbull","Spartanburg","Fort_Bend","Fayette","Boulder","Atlantic","Kalamazoo","Lubbock","Niagara","Lackawanna","Galveston","San_Luis_Obispo","Chatham","Prince_William_County","Lake","Lancaster","St._Charles","Broome","Saginaw","Manatee","Montgomery","Greene","Kanawha","Ada","Washington","St._Louis","Cumberland","Marion","Brown","Leon","Brazoria","Bell","Kitsap","Richmond","McLennan","Yakima","Davis","Ottawa","Howard","Barnstable","Larimer","Beaver","McHenry","Peoria","Montgomery","Harford","Butte","Clayton","Durham","Alachua","Saratoga","Muscogee","Merced","Sangamon","Gaston","Racine","Buncombe","Cleveland","Litchfield","Champaign","Placer","Jefferson","Arlington_County","Newport_News_City","Calcasieu","Lexington","Harrison","Ulster","Vanderburgh","Lafayette","York","Cambria","Wyandotte","Berrien","Thurston","Kent","Shawnee","Muskegon","Weber","Elkhart","Rensselaer","Clay","Schuylkill","Lake","Collier","Butler","Chesapeake_City","Smith","Tuscaloosa","Frederick","Clermont","St._Lucie","Bibb","Onslow","Jackson","Schenectady","Rock_Island","Clark","Shasta","Penobscot","Hampshire","Jackson","Washington","St._Clair","Fayette","Anderson","St._Tammany","Horry","Okaloosa","Sullivan","Middlesex","Portage","Ouachita","Kenton","Chautauqua","Yolo","Outagamie","Winnebago","Williamson","Rock","Berkshire","Cumberland","Greene","Calhoun","Dona_Ana","Hampton_City","Monroe","Webb","Weld","Chittenden","Rapides","York","Sussex","Madison","Tippecanoe","Blair","McLean","Porter","Tolland","Licking","Kenosha","Whatcom","Bay","Davidson","Richland","El_Dorado","Minnehaha","Centre","Tazewell","Carroll","Pueblo","Wichita","Medina","Brazos","Oswego","Franklin","Mercer","Aiken","Hawaii","New_Hanover","Merrimack","Delaware","Taylor","Humboldt","Ector","Stearns","Lycoming","Rutherford","Catawba","Macon","Pinal","Calhoun","Kennebec","Livingston","Marathon","Jackson","Florence","Lebanon","Yellowstone","Washington","Wood","Benton","Boone","St._Lawrence","Bay","Comanche","Alexandria_City","Kent","Charlotte","Jefferson","Napa","Rowan","Washington","Allen","Imperial","Monroe","Hamilton","Columbiana","Alamance","Pitt","Hunterdon","Osceola","Yavapai","La_Porte","La_Salle","Yuma","Midland","Randolph","Olmsted","Vigo","Clay","Androscoggin","Robeson","Gregg","Wayne","Strafford","Sheboygan","Fairfield","Sumner","Cass","Sumter","Sarpy","Windham","Kings","Wayne","Charles","Hernando","Martin","Montgomery","Maui","Morgan"],["CA","IL","TX","CA","CA","NY","AZ","MI","FL","TX","PA","WA","CA","CA","OH","MA","PA","NY","NY","CA","FL","TX","CA","TX","MI","CA","MN","MO","NY","OH","WI","NY","OH","FL","CT","FL","HI","FL","CT","TN","NJ","VA","CT","CA","IN","IL","NJ","MD","NV","MD","MD","UT","CA","MI","NY","MA","MD","PA","FL","FL","NJ","MA","CA","CA","AZ","KY","MA","AL","CA","GA","MO","MA","DC","OK","RI","TX","WA","OR","TX","OH","NJ","NJ","PA","GA","CA","PA","IL","OH","NC","TN","MA","OK","NJ","MI","LA","NJ","MN","CA","NM","IN","NY","CO","WA","OH","MA","NJ","LA","GA","DE","CO","MA","NJ","MI","MD","NC","PA","NJ","NE","FL","KS","FL","CO","MO","NJ","VA","CO","CA","TX","LA","AL","PA","FL","CA","PA","CA","OH","WI","WA","IL","CA","KS","GA","AR","NC","CA","PA","PA","NH","TN","FL","PA","NJ","SC","IL","CA","OR","NY","WI","IN","SC","NY","OH","TX","PA","FL","SC","TN","MI","OR","MI","FL","OR","FL","PA","MN","NC","TX","OH","NC","NY","CO","OH","TX","UT","IL","FL","VA","TX","NY","CT","NV","MS","IL","NY","IL","LA","PA","IN","NH","ME","NJ","TX","AL","WA","PA","CA","NJ","CA","OR","OH","SC","TX","KY","CO","NJ","MI","TX","NY","PA","TX","CA","GA","VA","OH","NE","MO","NY","MI","FL","AL","MO","WV","ID","PA","MN","PA","FL","WI","FL","TX","TX","WA","GA","TX","WA","UT","MI","MD","MA","CO","PA","IL","IL","TX","MD","CA","GA","NC","FL","NY","GA","CA","IL","NC","WI","NC","OK","CT","IL","CA","MO","VA","VA","LA","SC","MS","NY","IN","LA","ME","PA","KS","MI","WA","RI","KS","MI","UT","IN","NY","MO","PA","FL","FL","PA","VA","TX","AL","MD","OH","FL","GA","NC","MI","NY","IL","OH","CA","ME","MA","OR","MN","MI","PA","SC","LA","SC","FL","TN","CT","OH","LA","KY","NY","CA","WI","WI","TX","WI","MA","NJ","OH","MI","NM","VA","MI","TX","CO","VT","LA","SC","NJ","IN","IN","PA","IL","IN","CT","OH","WI","WA","FL","NC","OH","CA","SD","PA","IL","MD","CO","TX","OH","TX","NY","PA","PA","SC","HI","NC","NH","IN","TX","CA","TX","MN","PA","TN","NC","IL","AZ","AL","ME","MI","WI","MS","SC","PA","MT","AR","OH","WA","MO","NY","MI","OK","VA","DE","FL","NY","CA","NC","RI","OH","CA","IN","IN","OH","NC","NC","NJ","FL","AZ","IN","IL","AZ","TX","NC","MN","IN","FL","ME","NC","TX","NC","NH","WI","OH","TN","ND","SC","NE","CT","CA","OH","MD","FL","FL","TN","HI","AL"],[4060,946,1729,4205,790,71,9204,614,1945,880,135,2126,1291,20062,458,824,730,911,287,738,1209,1247,7208,864,873,966,557,508,1045,540,242,433,407,1974,736,280,600,1051,626,755,234,396,606,720,396,334,126,495,7911,81,486,737,47,480,659,1513,599,483,908,774,311,498,1846,5963,9187,385,59,1113,449,529,605,400,61,709,413,1013,1676,435,989,462,472,47,184,268,8142,608,448,413,527,502,556,570,222,856,181,103,156,1399,1166,497,780,153,2090,340,619,185,306,340,426,772,661,636,640,416,834,949,469,331,1875,1000,1019,2127,62,805,248,803,1576,1569,456,1233,756,1106,1495,1023,2739,576,1202,1764,837,3322,477,433,771,650,828,905,859,877,509,804,891,226,792,521,4824,724,816,556,657,917,524,467,836,347,308,757,543,710,4554,559,745,1868,572,802,570,653,889,493,410,174,1192,415,848,1998,664,664,54,906,802,666,6343,869,514,1213,725,882,374,457,695,836,305,904,805,628,525,520,325,446,1185,616,811,875,285,743,561,562,900,523,459,399,3305,440,338,228,839,561,707,809,741,790,675,903,1055,857,6226,550,1579,529,667,1387,1059,396,324,1042,4296,305,566,252,396,2601,435,604,620,1044,440,1640,143,291,874,812,216,1929,868,357,333,656,536,920,997,1404,657,26,68,1071,701,581,1127,235,270,991,688,151,571,727,170,550,509,576,464,654,397,779,953,2026,789,341,929,1325,663,452,573,250,767,707,206,427,400,3786,3396,529,2785,392,725,790,718,854,1134,936,413,369,492,611,163,1062,1012,640,439,1124,721,931,489,415,709,3807,52,551,3357,3993,539,1323,683,521,452,500,526,1184,418,410,687,273,2120,764,552,497,1712,809,1108,649,449,2389,628,422,586,953,772,672,1073,4028,199,935,393,916,3573,901,1345,1235,619,400,581,5370,609,868,568,1545,727,799,362,2635,950,617,1703,685,2686,444,1069,15,591,694,1272,754,511,333,405,4175,394,398,533,431,652,430,1322,8124,598,1135,5514,900,788,653,403,601,470,949,274,553,369,514,506,529,1766,666,241,513,1390,555,461,478,556,539,1159,582],[8863164,5105067,2818199,2498016,2410556,2300664,2122101,2111687,1937094,1852810,1585577,1507319,1497577,1418380,1412140,1398468,1336449,1321864,1287348,1279182,1255488,1185394,1170413,1170103,1083592,1041219,1032431,993529,968532,961437,959275,874866,866228,863518,851783,851659,836231,834054,827645,826330,825380,818584,804219,803732,797159,781666,778206,757027,741459,736014,729268,725956,723959,717400,713968,709705,692134,678111,677491,672971,671780,670080,669016,667490,666880,664937,663906,651525,649623,648951,633232,616087,606900,599611,596270,591610,586203,583887,576407,573809,553124,553099,547651,545837,543477,541174,516418,514990,511433,510784,506325,503341,502824,500631,496938,493819,485765,480628,480577,475594,468973,467610,465642,462361,456310,453060,448306,447745,441946,438430,435276,433203,430459,427239,423380,422822,421353,416444,405382,403662,398978,397014,396685,395066,393069,391511,388222,383545,380105,378643,376396,370712,370522,370321,369608,367585,367085,361364,357313,355660,355054,352910,349660,347420,340421,339574,336523,336073,335749,335113,328149,325824,320167,317471,311921,311554,307647,304715,300836,295039,292594,291479,291145,291130,287529,285720,285536,282937,282912,281912,281131,278850,277776,275572,275227,274566,273525,271126,265878,265475,265038,264806,264036,263590,262852,262798,261229,260120,259462,254957,254667,254441,252913,250836,249238,248253,247105,247052,245845,243135,240279,239397,238912,238053,237813,230096,230082,229734,228483,227813,226800,225421,225366,225339,224327,223411,222636,220756,219039,217399,217162,216935,215686,215499,213641,212907,212160,211946,211707,209085,207949,207619,205775,204584,198213,195257,194833,194594,192493,191707,191088,189731,189719,189123,188823,187941,187768,187328,186605,186136,186093,183241,182827,182201,182132,182120,182052,181835,181596,181276,179278,178403,178386,175093,175034,174821,174253,174092,173025,172796,171380,170936,170045,168134,167611,165365,165304,165058,164762,164587,163029,161993,161378,161238,161135,160976,158983,158330,156198,154429,153411,152585,152104,152099,152013,151976,151309,150522,150208,150187,150171,149967,149838,149756,149285,148723,147548,147036,146601,146568,146389,145896,145607,145351,145196,144508,144053,143776,143596,143196,142585,142191,142031,141895,141092,140510,140320,139551,139510,139352,138053,136731,135982,135510,133793,133600,133239,131821,131761,131556,131497,130943,130669,130598,130542,129180,128932,128699,128300,128181,127780,126994,126677,126137,125995,123809,123786,123692,123372,123051,122378,122354,121862,121771,121082,121003,120940,120317,120284,120005,119659,119655,119118,118934,118791,118710,118570,118412,117206,116379,116034,115904,115645,115400,115243,114344,113744,113419,113409,113269,112560,112379,111974,111723,111486,111183,110993,110975,110943,110765,110605,110006,109755,109303,108978,108936,108276,108213,107924,107776,107728,107714,107066,106913,106895,106611,106546,106470,106107,105986,105259,105179,104948,104666,104233,103877,103461,103281,102874,102637,102583,102525,101469,101461,101154,101115,100900,100498,100374,100043],[32.1,29.2,31.3,33.5,32.6,28.3,29.2,27.4,27.1,32.6,29.1,30.1,32.6,30.1,26.3,31.7,26.2,27.9,25.7,30.8,25.3,29.5,27.9,32.2,27.6,29.7,31.6,26.1,27.3,33.5,29.3,26.3,28,23.3,28.3,22.4,30.6,29.4,26.7,29.4,25.4,29.2,28.7,26.5,30.6,29,28.6,28.6,29,30,33.7,27.8,32.2,28.2,29,29.2,27.8,26.1,33.2,30.7,31.6,27.3,28.8,28.3,28.9,27,39.2,26.7,28.4,31.6,28.1,28.8,33.6,28.4,29.9,29.5,29.5,28.4,38,28.1,25.6,31.5,27.6,32.6,28.3,26.6,28.9,26.8,32,32.1,27.6,28.2,27.5,29.6,28.3,26.8,31,27.7,29.2,25.5,29.4,30.3,28.1,27.8,27.8,28.9,28.1,31.7,30.6,26.9,27.1,22.4,27.2,29.6,34.5,27.2,26.7,29,23.9,28.5,26.2,31.7,28.7,28.8,35.3,28.3,25.8,26.4,31.5,26.7,27.1,24.3,27.4,23.3,32.8,24.9,35.6,27,27.4,32.6,27.5,32.6,28.5,30.4,29.7,26.6,26.1,30,30,21.5,24.1,29.2,28.2,27.8,26.3,27.6,28,24.4,27.4,34.1,30.4,29.9,27.3,26.3,27.9,34.7,26.3,39.5,27.4,37.4,18.4,23.1,18.2,27.5,30.6,37.4,36.9,26.4,29.2,25.5,29.6,23.5,29.8,33.9,26.8,29.2,41.7,25.9,29,31.2,29.5,29.5,26.5,27.7,26.2,25.2,26.9,28.2,29,29.1,28.6,25.8,31.4,25.3,26.8,24.7,28,29.9,25.7,23.9,27,26.8,34.9,34.2,29,32.4,34.1,25.8,24.3,26.9,31.4,28.5,32.3,26.4,33.9,29,28.6,25.5,21,28.4,31,23.9,27.6,23.7,24.3,28.6,21.6,29.6,38.5,28.7,34.6,27.7,31.1,30,25.1,26.2,28.9,29.8,22.1,32.1,23.6,26.3,26,25.5,28.8,28.2,32.4,33.7,40.1,28.4,30.6,28.2,25.8,27.3,26,24.8,33.9,25.4,41.6,23.5,28.5,37.6,33.9,26.6,27.8,30,27.8,27,31.1,26.4,23,27.4,25.2,25.3,26.2,26.2,25.8,26,26.8,29.8,28.3,22.9,19,22.4,27,28.6,26.2,33.3,28.7,28.1,22.9,27.5,49.7,27.1,26.1,24.9,25.3,22.8,30,38.2,22.1,26.5,25.9,22.9,25.5,24.2,28.2,30.8,24.6,28.4,33.6,28.3,28.3,25.7,36.5,28.2,30.3,29.1,26.2,26,26.7,28.5,25.1,31.4,33,26.1,28.5,29.6,35.8,26.8,28.7,26.3,25.5,42.3,23.7,37,26.4,33.9,26.2,27.5,28.8,27.7,26.9,25,23,29.7,45,23.9,26.6,24.1,29.5,24.5,49.4,29.8,25.5,24.5,26.7,22.5,29,27.7,32.9,30.7,27.5,27.1,33.6,25.4,33.1,27.2,24.1,24.4,28.8,26.1,25.3,25.9,25.9,26.2,25.3,25.6,32,34.5,25.1,40.9,31.2,25.4,34.5,38.3,29.7,16.6,32.7,24.5,26,31,26.2,25.5,45.8,25.1,23.4,27.3,35.4,25.6,27.1,18.3,26,23.8,27.4,26.8,27.1,29.3,30.2,26.3,27.9,26.7,26.4,29.7,34.8,25.4,25.2,25.5,34.4,31.6,30.4,28.5,33.7,26.3,29.9,16.4,20.4,35.7,26.2,26.3],[9.699999999999999,12.4,7.1,10.9,9.199999999999999,12.4,12.5,12.5,13.9,8.199999999999999,15.2,11.1,8.699999999999999,8.800000000000001,15.6,12.5,17.4,10.8,14.2,10.6,20.7,9.9,13.2,8.300000000000001,10.9,10.6,11.3,13.1,15.2,9.6,13.6,14.4,13.3,24.4,14.1,26,11,12.2,13.3,10.4,15.3,6.5,14.7,10.9,11.7,8.699999999999999,12.7,10.2,10.5,13.7,6.9,8.5,14.5,12.3,12.5,13.7,14,15,10.6,10.7,11.8,14.1,9.4,10.4,13.7,13.4,12.1,14,12.3,10,13.1,14.1,12.8,12.1,15.8,8.1,10.5,13.6,7.3,12.6,12.7,12.7,15.5,8.5,9.699999999999999,10.9,8.4,13.8,9.4,11.6,14.4,11.5,12.2,10.8,13,15,12.2,11.1,10.5,12.3,13,13.8,9.5,13,14.8,12.9,10.2,6.3,11.4,8,11.6,23.2,10.2,8.800000000000001,7.8,13.1,10.6,11.4,18.6,11.4,16.6,8,16.6,10.7,5.9,7.4,13.4,10.1,9.199999999999999,11.8,10.9,22.8,10.8,17.1,12.3,14.4,9.300000000000001,13.2,8.6,9.800000000000001,9.4,4.7,11.5,11.9,8.199999999999999,13.1,15.6,10.3,12.7,24.7,19.7,13,11.9,9.300000000000001,10.8,10.1,10.4,9.800000000000001,11.4,10.1,14.7,10.2,10.1,15.4,10.3,9.5,13.5,7.5,13.1,8.699999999999999,32.3,11.5,32.1,13.8,6.4,6.2,5,11.6,12.3,10.1,7.6,17.1,5.3,7,12.7,11.9,10.5,10.6,11.4,11.9,10.3,11.2,12.7,15.5,13.9,13.3,15,14.1,9.199999999999999,13,10.8,14,8.9,10.6,14.3,12.3,10.8,11.3,14.3,14.4,12.6,4.9,9.9,7.6,14.5,10.6,9.800000000000001,15.1,19.8,10.5,14.1,12.8,3,12,10.8,6.9,15,12,28.1,11.6,13.3,15.7,10.4,17.5,16.9,13.4,22.1,10.8,8.199999999999999,7.8,8.800000000000001,10.7,10,13.6,13,6.1,9.800000000000001,6.1,22,9.6,16.9,9.4,14.2,8.6,8.300000000000001,17.3,5.8,10.7,9.300000000000001,10.3,10.8,9.199999999999999,13.8,12.1,12,16.1,6.7,14.1,8.800000000000001,12,8.300000000000001,11.3,9.300000000000001,10.9,8.9,10.8,13,15.7,8.300000000000001,12.6,18.7,13,13.7,11.7,15.1,13.1,13,11.1,11.2,13.2,10.4,20,27.5,22.8,13.5,8.4,13.7,11.4,9.4,8.699999999999999,21,12.9,4.4,12.3,16.5,15,13.8,14.1,11.5,11.6,16.2,6.6,12.3,18,13.6,8.9,12.7,9.300000000000001,14.3,13.1,9.4,11.2,11.5,15.7,9.6,11.1,12.8,7.6,12.6,16.9,13.5,9.800000000000001,13.3,8.800000000000001,9.6,10.4,7.9,10.2,8.1,12,10.6,8.9,14,9.5,17,10.5,9.800000000000001,9,11.8,12.6,12.5,12,12,12.9,11.8,11.6,9,13.2,10.2,15.2,12.8,9.699999999999999,6.7,10.7,14.4,17.2,11.4,12.6,12.5,12.1,12.7,12,12.3,9.300000000000001,10.5,15.1,8.4,11.9,14.5,13.7,12.4,13.4,8.199999999999999,12.7,9.4,11.2,15,12.4,11.2,10.2,10.1,8.4,12.1,13.4,8.699999999999999,10.3,10.3,33.8,10.9,16.5,15.2,12.3,13.4,10.2,8.6,8.199999999999999,14.9,14.8,9.9,9.5,13.9,23.8,13.1,17.2,13.8,9,12.2,10,15.1,8.5,13.4,10.7,13.3,10.2,10.7,14.6,11.3,10.2,9.800000000000001,9.4,4.8,12.5,7.7,11.6,6.5,30.7,27.5,7.9,11.3,11.7],[23677,15153,7553,5905,6062,4861,4320,3823,6274,4718,6641,5280,4101,2463,5620,5158,5281,3021,6147,3169,2456,3062,1385,1677,4020,2464,3706,1194,2748,2675,2774,4577,3164,1833,2851,1620,2025,2012,2417,2489,3226,1694,3161,1761,2936,2157,2811,4635,969,5444,1253,2094,4761,705,2438,1902,1269,3237,1367,1538,1637,1185,1168,1188,1841,2171,5674,2532,1814,3368,1695,2758,3674,1922,1862,795,915,2571,1254,1313,1300,1036,1374,1036,682,879,1093,1216,1114,2293,572,1158,1255,1007,2500,1362,1512,666,1585,707,1534,2867,502,1391,904,831,1237,622,1038,551,576,513,692,616,761,574,1147,1603,559,930,563,548,4189,719,679,583,840,311,841,850,594,495,558,522,875,595,1603,852,298,515,1173,271,1510,676,481,460,567,587,984,509,594,994,650,473,358,353,479,687,552,1357,1257,308,584,637,357,999,738,2188,497,729,308,462,631,468,201,291,216,291,1194,931,439,601,282,291,329,522,1101,270,535,486,603,1076,521,437,275,898,459,417,343,732,783,449,399,256,824,1001,199,429,376,225,375,231,1248,452,379,614,655,239,429,950,424,494,196,233,389,172,460,335,322,419,490,569,367,236,406,375,235,289,413,156,513,233,1032,301,231,166,163,695,336,278,197,160,581,125,247,327,191,1944,1180,215,360,185,600,142,234,469,217,278,382,329,61,615,354,248,145,313,258,411,361,172,301,494,199,283,264,451,182,266,164,213,108,147,167,282,127,212,349,299,172,82,176,438,104,127,403,209,173,267,268,348,263,113,143,124,199,282,175,178,377,340,101,268,263,164,339,228,242,88,171,375,181,134,172,171,163,83,107,172,696,246,121,133,140,232,213,171,170,164,101,140,203,178,78,144,147,376,178,98,142,259,243,125,170,79,136,150,128,182,297,237,217,204,207,153,199,232,133,179,171,61,133,241,68,172,170,211,162,262,208,128,142,746,132,101,127,652,123,183,124,345,114,162,168,82,172,257,80,132,496,184,98,114,149,104,118,139,69,1814,179,164,198,83,166,113,139,114,86,96,343,88,39,123,82,84,67,98,193,87,192,122],[27700,21550,12449,6179,6369,8942,6104,9490,8840,6934,10494,4009,3342,3349,8132,4152,8436,3904,5200,3284,5543,4086,2435,3672,3254,2855,5395,1056,4632,4011,4141,3540,4683,3164,2940,4458,2174,3068,2494,4918,2279,135,2486,1781,4654,1842,4841,1507,2011,6203,1322,2076,3640,1202,3077,2205,641,2425,2929,2623,1880,2009,1372,1681,2016,3559,6154,4602,1642,5757,3762,1903,4262,3487,2360,1650,1226,3009,1392,3068,1904,2443,1588,922,1194,1435,1499,2226,2021,3847,1306,2512,2041,1460,4018,2541,1140,1051,1726,2413,1668,3652,672,3021,1665,1912,1648,983,1488,298,813,1475,1830,617,1199,1241,1599,2889,1288,1840,1085,1026,7814,1150,530,742,798,860,1876,1898,920,1349,1306,1306,1031,1537,1382,1346,746,602,925,439,2785,1188,503,951,1041,1050,2178,1202,1495,1724,1358,1263,656,294,986,677,1268,1956,1246,878,1406,1305,352,1207,1573,1730,654,1438,941,345,1363,1417,283,586,458,941,1609,745,318,1473,571,544,1088,1584,1471,825,741,515,990,2118,910,905,1120,1868,933,927,514,1104,374,1724,933,299,1425,488,339,390,498,925,832,301,1851,387,990,793,1562,893,1136,1592,522,1112,153,359,778,613,816,1193,855,1102,1785,1342,557,687,1391,733,451,632,823,318,572,244,1787,560,518,248,313,208,384,409,616,371,1219,340,333,625,346,1496,1096,221,1168,337,1330,368,532,725,319,411,805,322,230,781,836,845,259,764,413,1376,1018,404,892,1019,688,500,359,661,660,573,478,616,693,634,664,431,261,210,795,731,241,151,425,1010,133,573,721,769,463,468,598,236,522,92,431,409,456,512,505,482,982,235,285,1043,733,653,168,511,528,185,491,598,534,210,566,240,251,182,382,281,573,768,276,261,655,635,654,588,379,173,192,334,214,478,221,463,163,912,270,297,123,555,457,226,279,269,296,653,191,391,554,368,494,467,311,389,661,668,215,464,725,309,486,497,93,254,346,731,196,554,651,124,278,1023,378,415,347,662,193,632,336,1019,244,241,560,221,285,122,485,340,583,182,291,159,519,504,197,333,145,1437,576,277,527,281,420,263,237,421,195,259,643,214,160,254,180,155,104,290,277,188,182,464],[688936,436936,253526,173821,144524,680966,177593,193978,244725,214258,109148,124959,77009,83110,73150,35825,50186,66723,43203,107338,107386,133098,95494,132495,50964,84305,71753,42595,55306,82680,73681,37118,57208,76142,51926,62344,51032,89895,44374,67032,28521,30202,52903,51243,61004,29708,75595,34754,52786,87355,54469,58610,71234,41048,43780,7099,46789,20335,52577,68586,30548,34312,30235,62004,57051,32419,68808,55604,30473,93025,61760,14830,64393,57045,34627,54002,41980,58216,60961,36665,22302,40581,18924,56950,36318,16894,22349,26228,57999,45237,22023,39496,34814,31553,54238,30299,30574,41179,41280,29926,23249,37466,20323,38194,24247,26434,41625,27582,27717,23453,14846,17379,33136,21826,26006,13086,12147,26006,37290,34071,23686,25234,64103,13034,23412,27587,18556,26712,41592,30409,9491,25736,25461,7445,18313,17466,20344,20042,16432,17870,15238,17119,42404,28212,21756,11292,12827,12843,22422,18442,4982,20153,20504,16721,19489,12630,10975,8935,19842,28190,15077,13850,28606,12254,17518,24101,23532,19367,16091,17337,12509,12855,19801,9936,10953,25247,20372,9864,21554,7194,19369,13181,17625,10605,14563,14380,25194,18842,9087,7807,18831,28841,19674,9234,10666,22091,6452,10637,7295,13816,8308,21677,6635,10706,11563,9460,9746,13707,14825,7315,17198,9433,17378,14124,25167,15306,14509,9437,4368,18586,8103,18732,9001,5481,16414,7785,7435,16190,16916,17388,13551,10246,9701,4526,7518,5247,14860,8101,23363,8692,10865,8996,17918,16486,15139,6279,6140,9057,7441,8921,4088,4854,12483,9469,6735,8939,15419,15477,18218,5281,11454,8587,11929,11865,11110,9512,12194,3593,11508,8904,3128,12526,11776,6399,9814,7043,4701,8405,10599,6027,3187,18902,12229,7882,7302,13845,12181,9191,7573,5297,11085,2119,7099,9426,3420,8427,11712,12377,4939,5114,9842,12701,7505,8630,6364,7154,10131,7336,4749,2547,7170,5365,6568,3612,7525,4447,12459,5153,6236,3409,2769,10605,6925,5178,10650,4860,6170,5724,7643,3862,9071,5221,9810,8850,8376,6726,12202,7901,4739,6101,9525,3174,5373,6141,3196,5949,4014,1799,1380,6616,7070,8634,5662,7977,5152,5625,4136,3140,3430,8640,10727,563,8203,3582,3155,2777,6835,7226,11892,3325,1064,6785,5737,14643,4101,3826,6072,6830,6103,6275,4901,4184,3760,3655,4777,8421,2919,3879,6122,3759,6249,5456,3851,4849,5979,8537,5846,3741,3064,5056,5233,3838,4734,8042,1657,1699,898,4152,4603,2068,9665,3952,6021,2982,5414,7546,2940,4310,3435,4560,4020,4318,9181,4682,3651,4433,625,3285,3401,7138,2689,1397,4449,2377,5279,4414,5081,6537,7130,4693],[70,73.40000000000001,74.90000000000001,81.90000000000001,81.2,63.7,81.5,70,65,77.09999999999999,64.3,88.2,82,75.40000000000001,74,84.3,79,82.2,84.2,81.40000000000001,76.8,72.7,74.09999999999999,79.90000000000001,84.59999999999999,82.2,88.2,82.3,76.40000000000001,81,76.3,81,75.59999999999999,78.8,77.7,78.09999999999999,81.2,75.59999999999999,81,75.09999999999999,81.59999999999999,91.40000000000001,77.5,86.5,76.8,88.59999999999999,70.09999999999999,90.59999999999999,77.3,60.7,83.2,85.3,78,76.90000000000001,80.09999999999999,77.40000000000001,78.40000000000001,83.8,78.8,76.90000000000001,79.40000000000001,80.2,79.40000000000001,66.2,80.5,74.09999999999999,75.40000000000001,73.8,84.09999999999999,77.8,79.5,88,73.09999999999999,79.09999999999999,67,63.7,83.2,82.90000000000001,83.40000000000001,77.8,82.8,64.09999999999999,81.40000000000001,83.90000000000001,67.59999999999999,82.90000000000001,84.7,78.3,81.59999999999999,75.90000000000001,65,81.7,75.5,80.3,68.09999999999999,75.2,85,68.59999999999999,82.09999999999999,73.5,80.7,79.2,85.7,76.2,73.59999999999999,68.8,76,85.8,80.59999999999999,89.8,83.8,74.90000000000001,76.8,81.09999999999999,85.40000000000001,70.5,87,84.5,68,82.40000000000001,82.3,88.3,62.8,81.90000000000001,88,91.5,84.40000000000001,46.6,80.5,70.09999999999999,84.90000000000001,75.40000000000001,68.40000000000001,77.7,80,76,88.90000000000001,84.40000000000001,80.40000000000001,72.90000000000001,92.90000000000001,86.7,79,76.09999999999999,82.7,72.8,70,82.2,74.59999999999999,76.90000000000001,72,77.09999999999999,71.59999999999999,77.7,60.2,88.2,77.2,88,81.2,75.5,80.90000000000001,76,68.90000000000001,74.59999999999999,84.59999999999999,79.40000000000001,72.5,87.2,83,83.90000000000001,66.90000000000001,85.7,81.3,77.5,90.7,80.3,86.8,75.3,77.59999999999999,83.3,78.8,74.59999999999999,88.3,87.90000000000001,72.59999999999999,76.2,72.7,50,79.8,80.90000000000001,82.5,75.2,76.3,75.09999999999999,75.8,73.40000000000001,73.09999999999999,76.09999999999999,86.2,85,86.3,74.40000000000001,80.2,83.90000000000001,77.59999999999999,91.90000000000001,77.5,81.90000000000001,78.7,75.2,63,80.90000000000001,80.2,91.3,72.90000000000001,83.40000000000001,74.2,75.8,73.3,75.8,83.3,73.7,87.8,81.09999999999999,88.09999999999999,83.3,78.90000000000001,74.8,75.59999999999999,75.3,78.90000000000001,72.40000000000001,87.2,73.2,80.3,81,69.59999999999999,82.59999999999999,84.90000000000001,75.5,79.09999999999999,86.59999999999999,70.90000000000001,71.59999999999999,66.09999999999999,89.90000000000001,79.8,91.09999999999999,88.40000000000001,88.59999999999999,74.90000000000001,84.5,77.90000000000001,75.5,81.59999999999999,77.59999999999999,77.2,78.90000000000001,82.7,83,71.5,63.1,81.8,60.9,76.40000000000001,74.5,83.90000000000001,80.90000000000001,87.5,85.09999999999999,71.59999999999999,87.5,79.3,70.3,77.3,74.7,76.59999999999999,75.2,73.3,79.5,71.2,69.90000000000001,74.7,86.5,76.8,84.40000000000001,74.2,82.5,72.8,77.7,84.7,68.40000000000001,70.59999999999999,79,78.59999999999999,77.09999999999999,75.7,69.59999999999999,80.40000000000001,72.8,71.7,68.2,83,77.7,80.7,77.40000000000001,73.40000000000001,78.40000000000001,79.09999999999999,83,80.09999999999999,90,74.8,67.8,64,76.90000000000001,74.3,83.8,66.8,82.59999999999999,79.3,71.59999999999999,74.40000000000001,74.40000000000001,79.09999999999999,81.5,80.59999999999999,81.40000000000001,78.2,77.90000000000001,63.4,82.40000000000001,76.8,70.40000000000001,79.7,74.09999999999999,47.8,74.90000000000001,86.7,69,67.5,85.09999999999999,73.5,85.2,75,84.7,82.40000000000001,84.7,76.40000000000001,75.09999999999999,83.2,74.7,64.2,73.5,85.90000000000001,83.09999999999999,83.59999999999999,78.59999999999999,78.5,73.90000000000001,75.09999999999999,82.40000000000001,79.8,74.7,69.40000000000001,75.09999999999999,70.7,77.7,78.09999999999999,83.2,74.5,75.40000000000001,80.5,66.90000000000001,78.3,74.5,73.90000000000001,66.7,76.2,65.5,67.40000000000001,78.90000000000001,85.59999999999999,75.90000000000001,74.40000000000001,64.3,70,83.7,73.2,83.8,83.90000000000001,84.8,73.09999999999999,74,81.09999999999999,86.90000000000001,73.09999999999999,75.7,76.40000000000001,80.7,66,82.8,76.09999999999999,53.2,82.09999999999999,88.7,71.8,67.90000000000001,71,85.90000000000001,73.7,78.90000000000001,73.90000000000001,73.09999999999999,64.90000000000001,76.8,62,88,76,81.2,71.8,57,75.8,71.2,79.8,77.40000000000001,78.8,70.59999999999999,87.09999999999999,69.8,91,71.09999999999999,65.59999999999999,73.59999999999999,81,70.5,79.7,77.90000000000001,77,69.40000000000001],[22.3,22.8,25.4,25.3,27.8,16.6,22.1,13.7,18.8,26.3,15.2,32.8,32.6,14.9,20.1,35.4,22.6,23,30,28.8,18.8,19.7,14.6,24,30.2,23,31.6,29.2,20,26.6,19.3,35.3,23.7,22.1,25.8,18.5,24.6,20.2,34.2,20.8,31.7,49,24.2,31.6,21.4,36,24,49.9,13.8,15.5,25.5,23.8,35,13.5,26.3,22.2,25,32.1,21.2,18.4,26.5,25.9,23,16.9,23.3,19.3,27.7,19.9,31.3,31.6,20,34.4,33.3,22.6,18.3,15.2,17.5,23.7,34.7,20,28.4,19.7,24.8,32.7,13.3,24.8,32,19.7,28.3,24.4,15.9,23.7,21,20.7,22.4,25,28.8,13.2,26.7,12.8,24.4,29,19.3,17,17.6,18.7,18.8,33,25.2,30.7,22.2,15.3,12.8,24.6,35.3,16.7,36.7,24.9,12.9,22.2,20.4,25.8,15.3,23.6,25.5,35.2,24.5,11.5,27.5,15.5,34.7,14.8,13,15.4,26.6,14.3,34.2,20.6,18,21.5,40.5,29.6,23.5,24.8,18.7,13.9,15.1,26.4,23.9,16.4,13.1,29.5,21,21.4,11.8,29.8,19.5,27.1,19,22.4,28.3,18.7,17,19.6,26.3,28,19.7,41.9,22.2,29.2,9.1,23.6,21.9,16.2,27.6,16.6,32.3,12.3,24.1,33,13,14,39.1,26.2,14.7,18.2,16.8,12,24.8,21.8,20.7,26.4,16.7,16.7,14.4,18.2,16.7,19.2,25.9,27.6,38.3,15.5,30.1,16.8,18.6,44,18.1,29.7,17.5,11.4,14.3,30.2,30.6,42.1,16.4,27.1,23.4,13.6,14.8,19.3,22.9,18.6,27.6,17.5,27.6,21.2,20.7,13,15.5,24.2,20.7,17.6,24.9,13.6,17.3,22.9,11.5,17.7,37.1,15.1,17.2,19.8,17.3,16.6,13.7,23.5,18.7,46.9,28.1,32.3,11.9,21,19.5,19.4,21.5,19.5,14.7,33.4,34.6,25.2,16.6,12,22.4,10.8,16.5,19.1,25.9,25,34.1,22.7,9,52.3,18.4,14.7,21,16.3,21.6,16,22.5,19,10.8,10.3,16.7,24.7,20.5,22.3,11.1,18,14.2,19.5,20,8.1,12.7,22.3,15.6,16.9,19.8,20,22,14.5,13.1,17,13.4,12.9,23,15,12.2,13.7,17.7,31.9,17.6,26.2,10.7,9.300000000000001,12.9,23.1,16,21,15.6,28.2,17.6,18.9,17,14.2,30.3,16.7,18.2,24.6,13.3,20.9,10.8,26,13.8,21.9,19.1,10.5,11.1,18.4,34,14.6,16.9,24.9,11.7,30.7,10.5,29,18.5,29.2,13,12.7,22,15.7,10,11.6,20.8,21.3,32.3,13.6,19.6,14,16.5,18,35.8,12.9,12.4,13.6,17.2,18.5,21.2,25.4,16.5,20.7,20,11.4,17.5,12.3,18.7,14.2,14.8,8.199999999999999,14.2,18.1,19.6,13.5,14.4,14.8,11.8,21.5,20,21.9,23.3,36.5,15.1,11,18.4,48.5,15,13.4,13.6,22.3,11.7,29.1,11.4,9.699999999999999,32.9,36.2,8.5,14.6,21.9,34.6,11.2,17.7,11.7,10.5,12.7,26.4,9.1,29.5,18.1,17.9,12.6,11,17.7,12.7,21.7,13.8,15.5,14.4,26.5,15,25.4,16.8,9,13.9,16.2,9.699999999999999,20.3,16.5,17.8,15.5],[11.6,11.1,12.5,8.1,5.2,19.5,8.800000000000001,16.9,14.2,10.4,16.1,5,5,10.3,11,4.2,8.699999999999999,3.3,2.5,8.1,7.1,16.2,8.4,8.199999999999999,4.4,9.800000000000001,6.4,4,9.4,9.1,12.6,4.7,10.3,6.2,6,6.2,5.4,9.5,4.5,14.7,2.7,2.2,6,5.5,9.300000000000001,1.7,11.3,2.7,7.5,17.8,3.7,7.7,9.699999999999999,4,7.7,6.3,3.8,2.2,7.8,9.800000000000001,3.4,7.5,5,16.8,12,10.9,14.4,12.7,4.3,15.4,9.800000000000001,3.1,13.3,11.3,8.9,22.4,8.699999999999999,8.9,10.2,9.800000000000001,3.4,12.4,5,7.2,13.7,2.9,3.7,9.5,7.2,10,7.4,10,8,6.9,27.3,5.3,8.1,12,10.9,11.7,7.1,13.1,4.9,12,10.9,7.6,11.4,3.8,5,4.1,5.3,4.3,14,3,5.5,5.3,1.8,8.1,9.4,8.300000000000001,6.3,8.1,20.6,3.1,4.3,4.4,5.2,36.3,15.1,17.5,3,7.9,11.4,8.6,7.4,8.9,4.8,9.800000000000001,4.5,8.5,2.5,2.9,10.5,7.3,6,4.3,5.2,4,10.2,6.1,8.300000000000001,5.3,7.8,5,18,4.8,6.4,2.2,5.6,13.8,6,7.6,17.2,4.9,5.3,10.1,10.2,6.4,9.4,11,7.9,4.7,4.6,9.5,3.3,12.1,4.5,9.1,7.8,4.1,8.800000000000001,12.8,3.9,10.6,13.9,13.3,15.1,33.7,3.6,4.7,6.3,16.7,7.7,8.800000000000001,8.5,19.1,4.9,7.1,3.2,5.7,1.4,15.5,8.4,7,7.2,3,4.7,6.2,9.4,9.4,8.800000000000001,6.9,10.2,5.6,6.4,8.9,13.2,8.6,7.8,12.5,6.8,13.6,2.3,3.6,6,3.5,6.5,14.7,6.8,14.1,9.199999999999999,12.3,6.2,9.699999999999999,9.699999999999999,2.8,10.8,6.7,9.4,7.7,12.2,7.5,14.8,13.9,15.6,5.5,3.8,2.2,5.8,6.6,10.8,2.5,11.3,9.4,4.1,12.2,7.3,8.699999999999999,14.4,4.4,14.9,15.4,7.2,8.199999999999999,7.9,8.199999999999999,7,2.4,8,5.3,6,4.3,12.2,15.5,6.3,15.4,5.6,9.1,16.2,4.7,11.2,13.9,11.6,7.1,3.7,7.4,12.4,7.8,5.3,6.6,4.2,7.7,7.9,6.4,7.1,7,12.6,13.5,3.5,7.4,8.5,15.9,9.800000000000001,9.4,5.7,10.2,10.4,11,9.5,5.7,9.699999999999999,3.6,9.199999999999999,17.6,8.6,11.1,11.6,7.8,10.4,2.6,7.6,19.6,8.199999999999999,9.9,9.800000000000001,4.6,5.3,7.6,7.8,6.3,10.2,7.1,11,20.7,8.800000000000001,6.9,33.1,10.6,5,18.6,7.6,2.5,10.3,6.8,11,5.9,4.6,2.7,8.300000000000001,7.6,7.4,11.2,7.3,8.4,5.8,5.4,6.2,7.1,2.5,16.7,12.5,4.1,14.9,8.1,5.7,10.1,11,10.9,9.9,3.6,10.3,11.2,12.8,16.6,7.3,8.4,7.6,4.8,9.800000000000001,18.7,11.7,7.3,3,5.5,14,15.9,5.2,9,9.800000000000001,5,8.9,9.300000000000001,12.8,10.2,13.3,4.7,8.699999999999999,5.2,9.5,4.6,6.8,3.7,10.4,20.8,9.5,2.6,13,6,15.5,1.8,6.9,9.800000000000001,7.8,8.699999999999999,15.4,11.5,6.5,4.5,10.7,5.4,8.699999999999999,20.7,13.4,11.9,5.1,4.5,6.8,7,7.3,16.9,3.5,6,15,8.4,3.7,7.9,5,10.8,5.7,9.4],[8,7.2,5.7,6.1,4.8,9.5,4.9,10,8.699999999999999,6.1,8,4.6,5.5,8,5.5,7.3,5.3,7,5.1,5.3,7.4,6.7,10.7,6.6,7.3,6.3,4.3,5.1,6.8,4.2,4.9,5.4,4.5,8.4,6.9,6.2,2.3,6,5.9,5.4,5.2,3.2,7.3,5.6,5,4.8,7.9,3.3,5.8,9.4,5,4.5,5.6,9.4,4.4,10.2,5.7,5,6.6,6.6,5.7,9,7,12.6,3.9,6.3,8.699999999999999,5.3,4.2,5.3,6.5,7.5,7.7,6,9,10.8,6.4,5.1,4.8,5.7,5.8,9,5.3,4.4,11.8,6.7,4.6,6,4.8,4.6,12.3,6.1,6.9,7.5,6.1,6.9,4.3,12,5.2,7.1,5.6,5.4,5.6,8.800000000000001,9.6,8.1,5.6,4.1,6.2,4.1,10.4,7.4,12.6,5,3.5,5.3,5.1,2.9,10.1,4.5,7.1,6.1,9,5.6,5.4,3.9,5.7,17.6,5.4,7.2,4.6,6.9,14.3,6.9,6,6.9,3.1,6.2,7.4,10.9,3.3,4,5.8,5.4,7,6.2,6.7,7.5,4.6,6.4,8.800000000000001,5.5,4.9,7.5,17.1,4.4,6.7,4.1,5.9,4.9,4.5,6.6,7.7,6.6,6.1,4.6,5.9,6,6.5,6.9,8.300000000000001,4.2,5.1,7.1,4.7,6.4,5.6,9.5,4.4,5.3,5,6.7,5.9,4.3,8.4,5.8,6.4,12.5,5.1,6.8,5,6.3,7.9,6.7,7.9,7.1,6.8,5.7,8,5.7,4.1,6.7,5.2,6.6,5.5,4,7.1,8,5.7,7.9,5.5,3.8,3.8,3.5,8.300000000000001,5.9,5.6,8.300000000000001,7.9,7,5.8,4.3,4.3,5.7,2.2,6.4,5.9,8.800000000000001,5.8,5.9,4.8,7.5,4.1,7,6.5,4.6,8.6,4.6,3.9,5.6,6.7,5.2,4.9,6.4,11.6,4.5,6.5,4.1,11.1,4.1,9.699999999999999,7.1,7.2,5.5,6.7,9.4,5.8,3.6,4.2,5.9,4.6,14.6,4.8,6.2,6.5,4.9,4.8,7,4.5,6.8,8.699999999999999,3.6,6.5,7.8,4.1,6.7,5.9,5.7,5,6.9,9.199999999999999,7.4,9.1,5.9,8.6,4.7,12,5.7,6.4,6.3,5.7,9.699999999999999,8.9,7.5,6.8,6.1,6.6,5.4,6,6,13.8,4.1,5.6,9.9,5.6,7.5,6.5,10.3,8,7.7,7.6,4.6,11.8,9.4,6.6,6.2,7.7,6.7,4.4,5.8,6,6.4,5.4,7.7,7.2,4.9,4.8,3.8,9.699999999999999,10.1,10.7,5.2,8.5,7.4,6.8,11.1,9.800000000000001,4.5,4.4,7.1,5.5,6.8,7.5,3.2,9,4.6,4.5,5.9,6.3,6.4,6.3,8,5.9,9.4,6.1,2.5,6.1,7.4,5.7,7,6.8,5.8,3.6,10,6.7,7.2,4.9,4,5.9,7.1,6.1,5.9,8.800000000000001,6.6,5.4,8,5.4,6.4,8.9,7.9,7.3,6.8,8.1,5.9,7.1,5.9,5.9,5.3,3.7,6.6,6.8,3.2,9.800000000000001,9.199999999999999,6.6,4.6,7.6,7.2,11,5.9,5.4,6.7,7.3,21.3,3.7,2.8,6.7,4.5,5.5,4.1,6.7,5.4,5.8,9.6,17.8,5.4,4.8,3.3,5,5.9,9.699999999999999,8.9,8.199999999999999,7.3,6.5,5.6,6.3,6.8,2.5,9.4,2.6,9.199999999999999,12.8,5.9,4.9,8.199999999999999,9.800000000000001,8,3.2,7.1],[20786,21729,19517,19588,24400,16803,18042,17461,17823,21001,16721,23779,25193,16399,21086,25312,20681,24262,31679,22148,22355,15508,17185,18825,26884,18934,23705,24219,18305,19040,18431,33330,20580,26798,24875,21610,21307,16876,32342,18430,32230,28999,22197,25523,19148,26772,24523,30081,18625,17263,19568,15399,28532,20924,21641,19895,23470,28462,17879,17662,24896,22834,21420,16365,15191,19140,23150,18624,28819,22819,18611,26909,23603,17741,17866,11545,16194,19215,18340,18410,27391,18463,23658,21005,15881,22548,27378,18583,20942,19505,18521,19295,19930,18674,16578,26248,20303,15453,17518,16327,19401,22156,18545,17815,19073,21973,17101,21933,22284,20997,21500,20974,16829,22797,20658,18878,31520,19629,14835,19276,17668,16807,18113,23008,17697,22507,22055,8899,17881,14389,24732,15648,15238,17069,21902,16898,20087,16365,18787,19465,26156,19861,18225,20349,17268,19502,19655,22581,17382,18877,16405,26026,17874,21684,14710,19932,19788,23004,19123,16015,21003,16750,15124,19785,17885,17137,18242,22782,15701,17458,13944,19942,24948,16331,21123,12923,17801,16006,20645,26757,16116,16256,22303,11467,16190,15392,16412,9728,22173,20259,21327,16215,18376,16477,17980,16337,18336,17211,21770,21362,33180,17418,18990,16790,18348,37541,18523,22025,16022,16144,15776,18301,19320,21421,24035,18288,15443,16647,16963,17744,17221,17776,20543,19692,17816,18753,18058,16904,17997,17469,16630,17192,18786,16625,15419,19254,13802,18490,16422,17951,13536,17009,15941,14925,15374,13394,18360,27546,23267,17140,15162,21855,18342,17084,20941,15051,16171,19238,16058,18857,15505,13961,19601,16319,18426,16934,14443,25161,16957,20168,15896,30242,15327,14968,18126,13691,18824,18093,16868,17908,14473,14134,16232,17312,20086,19558,14767,15301,16770,17774,18395,15853,17496,25589,17251,16924,17511,15113,19954,16231,14137,17548,10190,15750,20679,17818,16676,16277,15521,17853,15582,20682,17480,14051,14205,17129,14693,15803,15747,24132,16031,13869,16935,15197,19727,17182,17645,14934,16742,20068,16819,18161,15944,11379,14743,17278,8973,15874,19940,14615,16713,24405,16018,15847,14779,18961,17566,21944,16412,17338,16002,14814,15079,16191,19250,18526,15476,18008,22002,14197,17119,18892,12641,14834,16281,15177,17898,16728,17119,20600,15697,16021,16138,14766,14757,15778,15501,17396,18021,11396,13776,17131,21153,16305,13475,14961,16500,17272,14736,17522,17332,17175,12704,16499,13228,31699,14946,16362,15205,22668,15691,19449,16542,14523,14266,25681,12597,17306,15852,30255,16451,13681,16655,16119,11490,19345,14721,20515,15036,16029,16154,10849,16775,13350,17182,18061,16342,16514,16275,11803,16137,18070,13907,16464,19317,13919,27125,13169,18504,16458],[184230,110928,55003,48931,58818,38658,38287,36872,34525,38911,26512,35843,37728,23260,29776,35398,27639,32071,40782,28331,28066,18383,20114,22027,29131,19714,24474,24062,17729,18306,17680,29159,17827,23141,21188,18404,17818,14075,26768,15229,26602,23738,17851,20514,15264,20927,19084,22772,13810,12706,14270,11179,20656,15011,15451,14120,16244,19300,12113,11886,16725,15301,14330,10923,10131,12727,15369,12134,18721,14808,11785,16578,14325,10638,10653,6830,9493,11219,10571,10564,15151,10212,12956,11465,8631,12202,14138,9570,10710,9963,9378,9712,10021,9349,8238,12962,9862,7427,8419,7765,9099,10360,8635,8237,8703,9955,7666,9820,9848,9206,9358,9086,7244,9740,8746,7982,13281,8174,6014,7781,7049,6673,7185,9090,6956,8812,8562,3413,6797,5448,9309,5801,5646,6321,8095,6211,7374,5914,6713,6923,9287,7009,6373,7070,5878,6622,6614,7589,5836,6326,5383,8480,5723,6884,4588,6210,6088,7010,5753,4725,6145,4882,4403,5760,5142,4896,5209,6446,4442,4922,3920,5561,6930,4500,5814,3548,4869,4340,5489,7103,4271,4305,5889,3023,4256,4045,4287,2530,5753,5165,5431,4126,4648,4133,4481,4056,4531,4252,5352,5194,7972,4170,4537,3997,4363,8638,4262,5060,3661,3678,3578,4125,4354,4827,5392,4086,3438,3675,3716,3858,3740,3856,4431,4244,3806,3993,3831,3583,3810,3653,3458,3569,3866,3401,3056,3759,2689,3598,3161,3441,2587,3227,3024,2823,2903,2517,3447,5160,4342,3190,2822,4005,3353,3113,3814,2741,2944,3498,2916,3418,2780,2491,3497,2857,3225,2960,2517,4380,2934,3485,2724,5169,2606,2517,3038,2264,3112,2986,2779,2947,2360,2290,2619,2791,3237,3148,2348,2423,2619,2745,2822,2419,2661,3892,2622,2572,2650,2275,2997,2438,2123,2632,1527,2359,3087,2650,2461,2393,2275,2617,2281,3017,2545,2042,2063,2475,2117,2272,2261,3456,2286,1972,2405,2156,2783,2414,2476,2084,2336,2797,2322,2483,2168,1542,1973,2308,1196,2093,2627,1923,2198,3196,2093,2070,1929,2449,2265,2824,2106,2222,2045,1881,1910,2042,2425,2294,1916,2227,2714,1747,2095,2312,1540,1806,1971,1836,2165,2013,2059,2472,1878,1917,1922,1756,1753,1873,1838,2060,2112,1326,1598,1986,2446,1882,1553,1711,1877,1959,1671,1985,1951,1930,1423,1843,1475,3524,1659,1816,1687,2511,1736,2140,1816,1587,1555,2798,1364,1873,1711,3261,1772,1474,1783,1723,1228,2062,1568,2184,1595,1699,1700,1141,1761,1397,1791,1876,1691,1706,1674,1211,1655,1853,1411,1670,1954,1407,2737,1323,1857,1647],["W","NC","S","W","W","NE","W","NC","S","S","NE","W","W","W","NC","NE","NE","NE","NE","W","S","S","W","S","NC","W","NC","NC","NE","NC","NC","NE","NC","S","NE","S","W","S","NE","S","NE","S","NE","W","NC","NC","NE","S","W","S","S","W","W","NC","NE","NE","S","NE","S","S","NE","NE","W","W","W","S","NE","S","W","S","NC","NE","S","S","NE","S","W","W","S","NC","NE","NE","NE","S","W","NE","NC","NC","S","S","NE","S","NE","NC","S","NE","NC","W","W","NC","NE","W","W","NC","NE","NE","S","S","NE","W","NE","NE","NC","S","S","NE","NE","NC","S","NC","S","W","NC","NE","S","W","W","S","S","S","NE","S","W","NE","W","NC","NC","W","NC","W","NC","S","S","S","W","NE","NE","NE","S","S","NE","NE","S","NC","W","W","NE","NC","NC","S","NE","NC","S","NE","S","S","S","NC","W","NC","S","W","S","NE","NC","S","S","NC","S","NE","W","NC","S","W","NC","S","S","S","NE","NE","W","S","NC","NE","NC","S","NE","NC","NE","NE","NE","S","S","W","NE","W","NE","W","W","NC","S","S","S","W","NE","NC","S","NE","NE","S","W","S","S","NC","NC","NC","NE","NC","S","S","NC","S","W","NE","NC","NE","S","NC","S","S","S","W","S","S","W","W","NC","S","NE","W","NE","NC","NC","S","S","W","S","S","S","NE","S","W","NC","S","NC","S","S","NE","NC","W","NC","S","S","S","S","S","NE","NC","S","NE","NE","NC","NC","W","NE","NC","NC","W","NC","NE","NC","NE","S","S","NE","S","S","S","S","NC","S","S","S","NC","NE","NC","NC","W","NE","NE","W","NC","NC","NE","S","S","S","S","S","NE","NC","S","S","NE","W","NC","NC","S","NC","NE","NE","NC","NC","W","S","NC","S","W","NE","S","S","NE","NC","NC","NE","NC","NC","NE","NC","NC","W","S","S","NC","W","NC","NE","NC","S","W","S","NC","S","NE","NE","NE","S","W","S","NE","NC","S","W","S","NC","NE","S","S","NC","W","S","NE","NC","NC","S","S","NE","W","S","NC","W","NC","NE","NC","S","S","NE","S","NE","W","S","NE","NC","W","NC","NC","NC","S","S","NE","S","W","NC","NC","W","S","S","NC","NC","S","NE","S","S","S","NE","NC","NC","S","NC","S","NC","NE","W","NC","S","S","S","S","W","S"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>county<\/th>\n      <th>state<\/th>\n      <th>land_area<\/th>\n      <th>population<\/th>\n      <th>pop_18_to_34<\/th>\n      <th>pop_65<\/th>\n      <th>number_physicians<\/th>\n      <th>number_hospital_beds<\/th>\n      <th>total_serious_crimes<\/th>\n      <th>high_school_grads<\/th>\n      <th>bachelor_degrees<\/th>\n      <th>poverty_rate<\/th>\n      <th>unemployment_rate<\/th>\n      <th>per_capita_income<\/th>\n      <th>total_personal_income<\/th>\n      <th>region<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
xyplot(number_physicians ~ number_hospital_beds, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-13-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_beds = lm(number_physicians ~ number_hospital_beds, data=cdi)
predict(mod_physician_beds, newdata=data.frame(number_hospital_beds=c(1500, 5000, 15000, 25000)), interval="confidence", level=1-0.1/4)
```

```
##         fit        lwr       upr
## 1  1018.742   959.0148  1078.470
## 2  3619.650  3509.5556  3729.744
## 3 11050.814 10692.1448 11409.484
## 4 18481.979 17864.2500 19099.708
```

```r
predict(mod_physician_beds, newdata=data.frame(number_hospital_beds=c(1500, 5000, 15000, 25000)), interval="predict", level=1-0.1/4)
```

```
##         fit        lwr       upr
## 1  1018.742  -235.3335  2272.818
## 2  3619.650  2362.1685  4877.132
## 3 11050.814  9747.8245 12353.804
## 4 18481.979 17085.2942 19878.664
```


* **Interpret these intervals in your own words.**


---
### CDI: physicians vs population 



```r
xyplot(number_physicians ~ population, data=cdi,  type=c("p", "r", "smooth"))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-15-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
mod_physician_pop = lm(number_physicians ~ population, data=cdi)
predict(mod_physician_pop, newdata=data.frame(population=c(200000, 400000, 4000000, 6000000, 8000000)), interval="confidence", level=1-0.05/5)
```

```
##          fit        lwr        upr
## 1   448.4502   369.4239   527.4765
## 2  1007.5352   932.2852  1082.7852
## 3 11071.0647 10613.4697 11528.6597
## 4 16661.9145 15956.2521 17367.5769
## 5 22252.7642 21297.8827 23207.6458
```

```r
ci.reg(mod_physician_pop, newdata=data.frame(population=c(200000, 400000, 4000000, 6000000, 8000000)), alpha=0.05, type="w")
```

```
##   population        Fit Lower.Band Upper.Band
## 1      2e+05   448.4502   373.4242   523.4762
## 2      4e+05  1007.5352   936.0943  1078.9760
## 3      4e+06 11071.0647 10636.6332 11505.4963
## 4      6e+06 16661.9145 15991.9727 17331.8562
## 5      8e+06 22252.7642 21346.2188 23159.3097
```

---


```r
B = qt(1-0.05/(2*5), mod_physician_pop$df.residual); B
```

```
## [1] 2.5871
```

```r
W = sqrt(2* qf(1-.05, 2, mod_physician_pop$df.residual)); W
```

```
## [1] 2.456142
```

---


```r
mod_physician_pop = lm(number_physicians ~ population, data=cdi)
predict(mod_physician_pop, newdata=data.frame(population=c(200000, 400000, 4000000, 6000000, 8000000)), interval="predict", level=1-0.05/5)
```

```
##          fit        lwr       upr
## 1   448.4502 -1131.8777  2028.778
## 2  1007.5352  -572.6084  2587.679
## 3 11071.0647  9427.7193 12714.410
## 4 16661.9145 14932.9985 18390.830
## 5 22252.7642 20408.0448 24097.484
```

```r
ci.reg_fixed(mod_physician_pop, newdata=data.frame(population=c(200000, 400000, 4000000, 6000000, 8000000)), alpha=0.05, type="s")
```

```
##   population        Fit Lower.Band Upper.Band
## 1      2e+05   448.4502  -1593.374   2490.274
## 2      4e+05  1007.5352  -1034.050   3049.121
## 3      4e+06 11071.0647   8947.821  13194.309
## 4      6e+06 16661.9145  14428.111  18895.718
## 5      8e+06 22252.7642  19869.340  24636.189
```

---


```r
B = qt(1-.05/(2*5), mod_physician_pop$df.residual); B
```

```
## [1] 2.5871
```

```r
S = sqrt(5*qf(1-.05, 5, mod_physician_pop$df.residual)); S
```

```
## [1] 3.3426
```


---
layout: false


### Recap: Sections 4.1-4.3 

After Sections 4.1-4.3, you should be able to 

- Compute and interpret Bonferroni and Working-Hotelling simultaneous CIs
- Compute and interpret simultaneous prediction intervals
	
	


---
### Learning Objectives for Sections 4.5, 4.7 

After Sections 4.5 and 4.7, you should be able to 

- Understand the potential impact of measurement error
- Understand the challenges of choosing X levels when designing an experiment
	

---
###  4.5: Effects of Measurement Errors

---

### Measurement Errors in `\(Y\)`

When random measurement errors are present in the observations on the response variable `\(Y\)`, no new problems are created when these errors are uncorrelated and not biased (positive and negative measurement errors tend to cancel out). 

--

Consider, for example, a study of the relation between the time required to complete a task `\((Y)\)` and the complexity of the task `\((X)\)`. The time to complete the task may not be measured accurately because the person operating the stopwatch may not do so at the precise instants called for. 

As long as such measurement errors are of a random nature, uncorrelated, and not biased, these measurement errors are simply absorbed in the model error term `\(\varepsilon\)`. 

--

The model error term always reflects the composite effects of a large number of factors not considered in the model, one of which now would be the random variation due to inaccuracy in the process of measuring `\(Y\)`.


---

layout: true
class: inverse

---
### SHS: Measurement Error in `\(Y\)`

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:




```r
random_error = rnorm(n=length(spending_subset$income), mean=0, sd=sd(spending_subset$clothing_expenditure)/2)
spending_subset$clothing_expenditure_plus_error = spending_subset$clothing_expenditure + random_error

spending_subset[, c("income", "clothing_expenditure", "clothing_expenditure_plus_error")] %&gt;% round(3) %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b2bd2e59cd26719f5b6a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b2bd2e59cd26719f5b6a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000,77000,51000,42000,32000,78000,15000,19000,35000,40000,21000,33000,37000,30000,34000,20000,36000,25000,32000,17000,14000,28000,31000,36000,26000,60000,24000,78000,17000,42000,36000,46000,51000,46000,67000,33000,75000,40000,33000,41000,87000,25000,15000,38000,16000,24000,21000,52000,34000,68000,48000,33000,77000,16000,26000,22000,32000,85000,32000,42000,15000,77000,71000,35000,9900,39000,72000,60000,67000,64000,20000,28000,83000,80000,59000,34000,50000,35000,30000,26000,51000,62000,23000,11000,44000,39000,33000,21000,43000,39000,36000,64000,55000,36000,38000,29000,45000,34000,34000,43000,35000,22000,26000,20000,57000,31000,35000,35000,45000,40000,30000,50000,40000,55000,35000,60000,39000,19000,51000,30000,39000,70000,32000,28000,48000,25000,38000,23000,68000,50000,39000,65000,65000,36000,40000,50000,51000,40000,16000,57000,27000,49000,26000,36000,45000,46000,40000,34000,36000,25000,55000,18000,46000,25000,42000,53000,49000,60000,51000,21000,63000,12000,45000,56000,49000,20000,51000,82000,36000,72000,75000,83000,10000,36000,38000,20000,22000,46000,26000,51000,35000,55000,48000,33000,71000,32000,80000,50000,21000,24000,41000,34000,40000,61000,26000,66000,6100,53000,35000,30000,72000,55000,19000,80000,38000,38000,38000,44000,10000,21000,23000,72000,57000,31000,50000,60000,55000,67000,43000,31000,45000,40000,65000,50000,20000,95000,48000,36000,38000,46000,29000,24000,27000,63000,55000,27000,69000,65000,21000,21000,35000,28000,18000,57000,39000,16000,26000,31000,52000,51000,46000,56000,47000,90000,47000,32000,49000,30000,41000,74000,75000,38000,21000,38000,34000,46000,19000,33000,29000,23000,40000,22000,24000,83000,34000,22000,15000,16000,33000,43000,42000,38000,43000,22000,20000,42000,34000,32000,34000,51000,31000,24000,37000,22000,37000,21000,20000,27000,87000,37000,19000],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485,800,3960,4200,1775,550,1515,3145,900,2770,800,1070,1750,1530,652,880,1070,2670,4060,1490,1650,3620,4130,3501,750,4615,7440,2950,3827,1325,2200,4600,1500,100,1070,2330,800,1599,1400,2200,980,2500,540,2501,2135,892,1200,2120,2970,2945,2188,3350,5980,1615,3300,1673,1637,3710,4570,4890,2450,2880,1900,1805,265,916,2360,2400,1100,2830,1220,5420,1370,2430,3800,250,7020,3659,8930,300,1150,1119,900,1300,1900,5370,4950,720,1680,3301,1620,1400,1530,400,500,1805,2710,1805,1910,4225,2810,660,4600,900,1600,2150,2050,2355,950,2225,1925,4065,2365,1930,5065,4700,150,999,1665,1410,4210,700,1250,620,1215,580,855,1980,3750,8050,780,3132,4830,6400,1590,1630,2700,3190,610,2045,1185,400,2420,3275,660,2090,2815,4098,5230,2210,4105,1610,1750,477,3100,1522,2863,6620,2600,5380,5200,3050,1615,4401,1165,530,1840,2270,1902,4750,2690,2150,1350,6425,1520,1060,1885,870,1470,1525,1020,300,800,5699,3505,3450,6110,3160,575,730,1850,1590,2950,4780,1150,3270,50,2835,1800,413,2550,305,1130,4335,1340,5700,1700,1850,1172,1900,2185,1500,7725,1375,7264,3907,2810,4575,3560,4866,2509,1290,5075,6175,1499,3120,3400,2580,965,485,1765,650,8820,7000,1710,2030,3085,410,374,1875,3510,2655,1095,1750,950,832,1125,1558,2220,1214,2320,2298,2445,2330,3900,1709,3220,1185,3160,250,1550,2800,890,2529,924,755,850,1660,2562,1680,2130,2644,1450,3470,310,419,1720,1182,1500,2350,910,5880,2600,2090,150,3070,5870,1250,3425,2055,900,150,2899,3030,1375,2752,970,932,2076,850,225],[6188.391,2334.776,659.053,1489.539,1575.718,3150.133,2240.106,2788.438,1407.692,3479.992,1393.584,-578.953,979.204,2094.723,468.803,2286.79,9399.171,3580.998,534.0069999999999,3702.35,1344.618,3208.359,6530.09,3882.295,1143.817,2587.579,359.442,2262.455,-35.188,1132.586,654.546,3146.789,3223.27,-535.437,3996.685,1170.095,-212.871,4027.895,784.048,2552.007,1473.393,1378.054,1245.838,1553.288,7755.06,1534.117,284.866,3654.668,2203.396,2835.436,5735.784,1998.302,3000.412,962.5599999999999,1927.885,1962.794,989.9299999999999,1279.255,-1525.645,1894.912,679.904,3647.063,2694.309,1530.58,4164.58,2104.416,1343.365,-428.576,1078.707,2639.107,-260.917,3233.585,1751.44,4601.66,3034.017,2186.959,833.773,503.272,921.414,1218.808,279.726,1872.67,1341.056,1750.235,5660.036,699.428,2480.771,4586.673,1627.764,1028.946,4062.907,4314.094,3486.323,993.518,1821.373,716.516,3087.441,453.599,3412.318,4005.599,-112.556,1077.969,2181.658,2305.603,2109.728,7102.132,3980.667,321.795,1226.404,720.881,5527.675,1098.275,2675.073,804.991,4129.83,2791.298,1215.001,941.641,2448.418,809.4450000000001,2289.171,2505.721,6304.063,5941.613,2303.067,2363.582,392.402,5457.695,1064.147,4116.133,2866.122,-162.106,2155.995,1660.051,6515.514,4502.014,4752.843,3583.024,9952.422,3722.901,8633.332,3043.918,1513.812,1107.237,1498.307,2240.437,942.202,3849.373,1864.636,3635.494,3286.103,3118.848,5890.269,3974.299,2503.019,1063.224,3897.452,1980.056,3498.391,710.317,1215.656,1574.198,5997.525,985.405,3817.559,1659.647,4775.378,3339.164,3524.137,2709.477,4912.568,2243.605,2220.761,-664.561,5832.206,6591.644,1171.828,2999.034,1574.211,1375.92,2205.732,-198.212,3049.218,1887.237,4243.395,3559.506,1008.661,820.324,3561.021,256.013,2832.088,8010.618,4.798,1919.942,1154.074,4138.362,3503.724,5343.587,3443.487,-41.832,1536.608,4082.857,4098.046,888.218,838.33,1105.352,3475.606,-593.489,3806.963,31.301,1730.561,1978.322,2240.294,403.245,271.124,1241.634,2208.413,5480.555,1280.08,1641.132,3471.965,3501.486,2847.883,112.14,4907.362,6403.745,2485.44,3853.169,459.717,2306.078,4776.982,2287.535,599.349,1892.557,2741.819,782.465,37.698,-191.271,3573.575,-271.188,1031.165,506.983,2630.199,3196.816,848.698,3316.456,1257.649,2559.166,2359.331,2772.658,1946.222,4744.302,2970.811,2961.294,2932.964,2129.588,5549.609,3735.357,4092.781,3317.57,1216.804,2163.154,1587.366,1361.212,2109.653,1662.815,1863.829,2088.031,3495.422,1675.915,5102.873,476.069,1710.496,4032.536,691.932,6408.756,2816.684,9653.674000000001,1967.904,509.128,976.607,2290.443,503.58,957.039,5764.82,4405.834,884.997,165.858,3254.227,830.804,1104.738,1439.19,85.292,-723.722,1988.238,3450.125,2222.594,2126.367,3017.281,3575.669,-891.526,4963.944,320.229,1326.267,3638.274,2591.301,1705.222,1677.743,1589.444,494.64,4133.853,1388.701,1919.594,5867.86,3776.289,-96.044,1606.12,2085.714,1266.559,4190.515,113.96,1599.754,-149.903,1594.682,2709.165,568.8579999999999,3197.505,3149.324,7810.577,-789.265,3612.557,5406.876,5964.996,598.718,2268.39,2215.68,3401.746,1569.389,2131.962,482.958,-81.807,2858.367,3036.979,755.379,4035.529,3386.182,2526.584,4903.794,675.174,3624.904,1562.649,1357.645,936.919,4227.671,1011.636,4473.87,6145.516,1344.01,5268.705,5385.44,2891.511,2835.622,4508.974,1162.326,1502.432,2035.028,1901.694,3325.043,4152.406,1596.823,1019.215,2057.32,6198.519,975.569,-957.7329999999999,1380,714.202,1387.784,662.829,1398.055,1655.82,74.244,4653.323,2751.019,4096.61,6313.058,2670.852,-220.469,800.796,1505.952,932.5599999999999,2672.469,4591.8,-259.983,3877.726,1825.81,2035.506,1008.101,1592.899,2653.681,850.127,1221.742,4322.525,933.3869999999999,5604.508,1398.994,1070.527,1289.334,2770.156,1986.763,1004.4,7018.449,794.982,6908.522,3040.938,2803.955,5120.819,4447.853,4014.858,2199.03,295.778,4600.925,5863.067,491.453,1766.661,3101.076,3289.035,1577.11,1267.249,2234.945,1228.773,8560.203,7869.635,-307.574,2411.382,3050.84,-414.645,-932.619,2890.748,4202.156,2942.406,1042.847,283.274,1643.743,680.206,1502.544,1173.54,3286.343,1219.519,4168.901,1580.707,1697.685,1669.333,5880.379,3095.482,2911.063,2105.937,3484.331,-384.195,2294.327,3082.041,1238.235,2339.478,761.575,162.964,1492.744,1590.868,2894.73,249.131,1892.637,2063.638,-204.245,2701.336,908.054,1565.628,1719.313,708.043,1131.223,444.478,144.994,6299.835,2971.519,2577.963,-344.244,3165.24,7522.386,1568.767,2511.433,2125.677,-441.24,-32.864,4069.307,3057.458,1960.329,2919.334,2569.488,779.818,2112.932,980.434,-2113.507]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>income<\/th>\n      <th>clothing_expenditure<\/th>\n      <th>clothing_expenditure_plus_error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r"), ylim=c(-2000, 10000))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-22-1.png" width="504" style="display: block; margin: auto;" /&gt;

---


```r
xyplot(clothing_expenditure_plus_error~income, data=spending_subset,  type=c("p", "r"),  ylim=c(-2000, 10000))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-23-1.png" width="504" style="display: block; margin: auto;" /&gt;


---

```r
msummary(lm(clothing_expenditure~income, data=spending_subset)) 
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.578e+03  1.864e+02   8.465 2.89e-16 ***
## income      2.116e-02  4.126e-03   5.129 4.17e-07 ***
## 
## Residual standard error: 1646 on 498 degrees of freedom
## Multiple R-squared:  0.05018,	Adjusted R-squared:  0.04827 
## F-statistic: 26.31 on 1 and 498 DF,  p-value: 4.174e-07
```

```r
msummary(lm(clothing_expenditure_plus_error~income, data=spending_subset))
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.632e+03  2.108e+02   7.746 5.37e-14 ***
## income      1.800e-02  4.664e-03   3.860 0.000129 ***
## 
## Residual standard error: 1860 on 498 degrees of freedom
## Multiple R-squared:  0.02904,	Adjusted R-squared:  0.02709 
## F-statistic:  14.9 on 1 and 498 DF,  p-value: 0.0001285
```

---

```r
anova(lm(clothing_expenditure~income, data=spending_subset)) 
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##            Df     Sum Sq  Mean Sq F value    Pr(&gt;F)    
## income      1   71258930 71258930  26.309 4.174e-07 ***
## Residuals 498 1348849454  2708533                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
anova(lm(clothing_expenditure_plus_error~income, data=spending_subset))
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure_plus_error
##            Df     Sum Sq  Mean Sq F value    Pr(&gt;F)    
## income      1   51561580 51561580  14.897 0.0001285 ***
## Residuals 498 1723729572  3461304                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


---
layout: false

### Measurement Errors in X

Unfortunately, a different situation holds when the observations on the predictor variable `\(X\)` are subject to measurement errors. 

At times measurement errors may enter the value observed for the predictor variable, for instance, when the predictor variable is pressure in a tank, temperature in an oven, speed of a production line, or reported age of a person.

---

layout: true
class: inverse

---
### SHS: Measurement Error in `\(X\)`

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:


```r
random_error = rnorm(n=length(spending_subset$income), mean=0, sd=sd(spending_subset$income)/2)
spending_subset$income_plus_error = spending_subset$income + random_error

spending_subset[, c("income", "income_plus_error", "clothing_expenditure")] %&gt;% datatable()
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c5f6cec3f29d5dfb38bb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c5f6cec3f29d5dfb38bb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],[68000,48000,30000,30000,35000,26000,26000,72000,20000,78000,46000,35000,50000,34000,40000,53000,85000,21000,50000,34000,45000,41000,32000,35000,68000,24000,23000,83000,45000,35000,33000,57000,50000,38000,75000,76000,74000,21000,45000,66000,38000,23000,26000,15000,69000,24000,60000,38000,36000,60000,30000,30000,40000,68000,52000,52000,21000,42000,60000,54000,53000,40000,70000,25000,59000,65000,31000,13000,35000,35000,45000,50000,50000,30000,42000,75000,69000,37000,95000,45000,37000,30000,40000,28000,45000,29000,28000,37000,60000,34000,41000,50000,58000,52000,69000,40000,90000,31000,33000,60000,35000,17000,27000,19000,43000,24000,46000,20000,45000,10000,84000,34000,55000,20000,32000,40000,26000,30000,70000,44000,46000,41000,70000,50000,82000,42000,23000,35000,33000,16000,54000,20000,32000,62000,27000,33000,24000,46000,77000,31000,32000,34000,19000,50000,31000,75000,25000,55000,29000,55000,25000,29000,43000,65000,53000,26000,43000,27000,50000,23000,14000,32000,38000,53000,30000,30000,45000,28000,50000,55000,60000,59000,55000,24000,42000,21000,54000,50000,48000,8000,52000,26000,45000,42000,21000,51000,37000,26000,59000,22000,37000,28000,30000,66000,25000,62000,49000,74000,34000,42000,77000,51000,42000,32000,78000,15000,19000,35000,40000,21000,33000,37000,30000,34000,20000,36000,25000,32000,17000,14000,28000,31000,36000,26000,60000,24000,78000,17000,42000,36000,46000,51000,46000,67000,33000,75000,40000,33000,41000,87000,25000,15000,38000,16000,24000,21000,52000,34000,68000,48000,33000,77000,16000,26000,22000,32000,85000,32000,42000,15000,77000,71000,35000,9900,39000,72000,60000,67000,64000,20000,28000,83000,80000,59000,34000,50000,35000,30000,26000,51000,62000,23000,11000,44000,39000,33000,21000,43000,39000,36000,64000,55000,36000,38000,29000,45000,34000,34000,43000,35000,22000,26000,20000,57000,31000,35000,35000,45000,40000,30000,50000,40000,55000,35000,60000,39000,19000,51000,30000,39000,70000,32000,28000,48000,25000,38000,23000,68000,50000,39000,65000,65000,36000,40000,50000,51000,40000,16000,57000,27000,49000,26000,36000,45000,46000,40000,34000,36000,25000,55000,18000,46000,25000,42000,53000,49000,60000,51000,21000,63000,12000,45000,56000,49000,20000,51000,82000,36000,72000,75000,83000,10000,36000,38000,20000,22000,46000,26000,51000,35000,55000,48000,33000,71000,32000,80000,50000,21000,24000,41000,34000,40000,61000,26000,66000,6100,53000,35000,30000,72000,55000,19000,80000,38000,38000,38000,44000,10000,21000,23000,72000,57000,31000,50000,60000,55000,67000,43000,31000,45000,40000,65000,50000,20000,95000,48000,36000,38000,46000,29000,24000,27000,63000,55000,27000,69000,65000,21000,21000,35000,28000,18000,57000,39000,16000,26000,31000,52000,51000,46000,56000,47000,90000,47000,32000,49000,30000,41000,74000,75000,38000,21000,38000,34000,46000,19000,33000,29000,23000,40000,22000,24000,83000,34000,22000,15000,16000,33000,43000,42000,38000,43000,22000,20000,42000,34000,32000,34000,51000,31000,24000,37000,22000,37000,21000,20000,27000,87000,37000,19000],[75015.2433437326,71397.34935560373,42931.055338764,41018.03417196479,43377.13753917838,5107.163043773573,40542.26628035841,69015.87378747005,31208.14079000002,81777.69739408813,62153.89132135426,39780.32534728093,47016.23120844306,35396.12270408723,41051.62147793337,49515.25607050638,91057.50423506484,29506.74957512969,53164.77056683635,42165.86224922721,35831.4769522126,39124.34882548339,22328.21706747435,22647.38397280976,68520.02599961465,23165.38881762755,19845.79829173908,63250.32964979927,43665.23333230691,44494.30706209496,33726.26434008895,58354.34843613827,53976.22752667677,44046.54266255841,80434.92289239091,80557.9526318844,82514.49442992176,20869.94868205364,43410.99242235628,76886.06750060679,47184.19130712118,23262.72631791251,14208.5956986519,-2390.372901047918,82728.73512678473,20544.4873825257,67630.26988804141,39514.70505431374,38170.88294157589,46289.88605902398,42188.96116619481,16131.90249509732,41710.71215494714,63892.10083152624,47698.31653180201,58385.52430891745,14993.44986481144,38295.30385570622,70202.53767929223,48999.68047566064,64727.63178600356,30302.2927530447,90980.17062463897,32186.79488336983,67932.71431366718,53319.42562020455,35038.40922051646,411.2243288070804,20270.03428968963,42740.83177410516,44121.54748767197,53104.69892162744,50394.23397163865,27040.37604976864,39643.69481022996,61750.84052147398,49862.96903276366,23051.66421372205,91898.24259024777,45297.67702946663,30242.08956262228,41064.00980213285,45985.36557480378,31084.96268971204,54291.05656727439,38487.37261893527,14339.05125582518,23166.21734685186,64506.65079115591,28864.63846404196,46310.99678639264,52628.85373555992,55011.45196145617,50315.00290253652,71059.92167204063,39417.63591781148,73341.46884404437,31984.64537766904,41567.96291689436,65071.90940809363,42429.3278473155,22340.35211237523,24417.48963170933,2904.851165507889,54481.3223960117,32580.96672475267,49495.30383510632,24140.8480624547,52434.23245051736,-19522.27576088191,80304.10608933998,29121.87377865768,48562.80825167643,32424.60019697028,25112.34592433508,57793.99631786988,27459.15270001473,26267.91257646825,64358.60549120711,49628.33959563217,53957.37353047909,44435.71152343939,69376.38015942721,52454.31043342038,72653.52680114552,46735.78163326105,15579.02222966805,30581.99793253019,33265.78907771862,16461.95926431155,49430.63734196067,16789.96990625698,27377.61368848205,43412.56800759293,13928.94117516678,24308.43080241359,34007.76032910537,48049.15256486007,83601.59038233565,40830.7225650492,19612.36024753551,44075.76489559331,15520.14896585479,51027.96646514647,31082.92887312234,91302.48204705176,18887.59617262895,63987.09953011734,25709.82030961274,60619.0834227076,8427.725091199372,23221.9243410268,55134.32499655798,62132.56659375181,46506.68159425449,7503.958116815727,48248.97586604585,26004.82245334194,45490.7268576911,25046.29646299908,22962.17247505541,30414.65542505415,42247.60163171511,59309.35011915746,29464.58187326133,40370.4742850201,57548.55371463344,31484.48073016572,45434.59456957999,50549.65499842756,61244.73607905796,62519.42295163573,40129.24813094764,28361.73671320848,37720.15142485529,30085.40260485862,46752.62069504915,45928.37199715724,52882.82191415592,18433.25117073715,62727.41909071978,40432.91830167184,54434.44431043448,34821.98525544642,22699.54938851541,53858.11246368799,34019.56590976285,22189.94711505147,53997.49265482744,28597.72947831828,44359.40333340874,38316.2377504489,20396.2978057013,60239.57694590075,25089.54879593398,71084.38854994881,50739.34548215294,87215.07769793356,21554.87750807613,33186.90438935696,61003.83458923869,43207.53294981419,51797.66684249554,36620.84914405992,85191.26999135307,1248.37562736544,30070.14249611045,45092.01666672976,50588.32406168059,15392.67645981977,20745.93143527057,32632.05582546385,35188.52568641058,29979.79219320974,20568.94903310703,28928.41056410536,11764.96667408028,25235.16981325708,15196.81251867152,31203.3540423163,29617.82098713428,23178.2728334221,25241.17115557885,29640.4093247795,67493.72949217899,20460.61342411591,82312.42802759787,8416.983131806934,51486.12353870535,33426.30682149733,31815.08140551917,59079.76202802965,47704.30397846828,75067.7656965098,24156.33008207909,84613.84001310586,31472.86536276543,32229.1085400704,44561.87149160209,93590.48926822896,16709.09532777086,11029.76212455455,31400.67285290165,4452.104869178826,36348.24117416004,36145.5449479759,54127.01465342689,40406.32694257371,65714.2133332425,61208.60359453521,25810.92093961201,84175.7702658979,19548.51815824516,16122.0733484711,20995.75797944688,27647.58864886229,96635.00839376992,38735.06409935472,54280.2703128904,-2207.743094631438,92823.36548920569,71145.32284509385,50359.1423000769,-6539.813902411657,30918.60119631713,79522.29918556534,68618.3076172022,63576.58644457971,68615.60590381069,9989.576695683398,25162.44300500937,98515.16607737083,83434.93368775224,71897.54154422529,26243.53822144681,55315.92879144722,34174.00975807871,24854.59412994434,12299.3197905123,46687.84996955771,58311.58277359042,30983.41910007846,13826.82758126038,30979.284650281,46000.53454912186,26071.16813730925,16557.60480594152,48591.35685192738,23899.55563686568,24627.28540653672,59690.57137492663,51863.38118882033,27172.03394494542,38086.35286030178,29745.10071881084,35671.90079929111,39626.66468377237,35933.99232470925,35500.2200751213,33690.39005983039,13211.52142502035,26607.88099850579,30783.535415498,46140.99542683351,6090.715003766065,43179.32458694525,28553.80900185238,38469.16819989226,47557.8155940599,38989.38949143334,45378.58500239776,56603.04669817605,47312.91395068391,34508.49060013193,52565.11649202686,39192.29578136401,25306.97100159965,64447.96720959387,28509.5810330663,47241.32043447531,71321.68979648917,20752.95679351103,35807.30731570783,50584.00446715859,10545.56955191494,50961.03285837343,20608.97864230817,68942.35465356048,63157.93321802791,45005.44752277603,62288.9345979877,73085.83258328134,38015.51832267757,14225.41487262634,46923.88515486212,48585.20809114658,53312.64523520123,16314.48233941311,55258.06779208418,27248.17953524362,62514.83717866609,19396.70289629183,48609.45301083699,44985.74245434941,54313.19100784235,38300.93073736508,9825.011365735369,34095.32693221515,18605.89345420162,51111.98995762064,10483.82572109227,57581.86008342502,38530.2334131378,41508.0768618014,59455.07645627388,43127.53088959435,49837.67644438014,37682.53146103348,36795.32266398054,60857.99064153993,25913.81215039147,25683.57423507604,61011.69446541454,40803.59190070157,38039.26296806823,48229.36466651284,73824.59999826596,28143.18431756505,68432.43039519805,85867.02306261037,80354.00848503785,407.0654040201935,41633.65801198134,39869.48358098575,18123.62647183649,42766.02381105051,58462.01480241713,31274.87491549011,46715.16021438611,29562.35866238484,59299.86005253034,53857.56098298497,21727.00136728142,78638.34724329565,40239.2704425779,79063.8465331748,49427.78232648622,13430.19905094331,28622.74936903237,54968.09531710933,11050.34241319484,35240.79425309641,47288.45983570268,36721.95341444662,74873.99815509201,-11061.276663999,52590.23306664474,30441.80570860165,28549.30775022336,62713.1522150289,64160.37611432574,19473.19084150108,78098.15562461044,49725.7554244826,31239.07950183985,24223.26100472195,43995.19558997615,15669.01415636262,38432.81657770681,17951.11179234484,83410.37675104642,58773.52829751487,30296.39570765113,42002.18038813108,69253.00251543117,58223.07517568004,64807.65093354307,48516.05572229,41578.64707138196,37802.71989527193,36980.50222228353,44672.33010041404,47270.75222198777,21729.48107883073,90305.30813273095,44832.8356426128,18842.70308243996,45405.82509245991,44313.63760271545,24692.40493698499,32693.9230461853,36121.16419738027,68861.13909459054,54381.83439739465,25792.44251121429,83706.26023831013,65651.98665927349,14314.3210855144,30565.08841881875,20094.51005670906,23505.32599491279,12408.83009074865,69411.17523770654,32015.69678186186,21268.06975249725,29801.56593257801,42822.56139721209,63166.59198986323,44338.17815699351,45068.42453648068,58351.7030080721,42869.08356187306,93226.73711906098,53535.30882868392,17829.04051539461,35244.24221451825,20722.0876678345,40270.93019468212,70423.06430628587,76463.04328979686,51342.14988655473,41462.9631521366,38314.088830442,35344.29865626265,46232.64458335802,28323.92623579574,41446.20710011607,11904.12106081228,32736.47240713036,42051.54953796073,28278.2036926245,30419.67989284878,88723.42721608828,39810.80937960591,31433.26992998325,-602.9160382234713,5523.000144164163,42340.93089269348,30264.16854375914,40610.73742607387,44078.71981266026,40847.204834088,21089.24722975971,21216.66635875107,27339.08872862414,35247.68309223071,22964.04268780282,19205.51423438867,47500.90170577433,25001.25105336804,32523.49908663997,25606.64200301745,19467.66109634371,28323.89333008501,19198.24413219829,21067.51492612785,32311.88341681119,89552.01247478244,35544.6206490668,41947.80388269077],[4200,1930,2340,2900,1300,3610,2560,2030,595,2315,1665,900,3050,630,1250,2990,8970,3260,1120,2760,1450,2290,5899,3620,1360,1650,58,2070,1350,1800,313,3000,3440,1570,2475,630,1570,3001,955,3790,1910,1860,2205,4180,7790,1900,1000,3280,2355,1740,5520,1240,3450,1130,3140,3040,1500,1408,455,1000,1120,3410,2655,1800,3830,2250,1100,500,1200,3545,200,3620,2172,3940,1644,2090,909,935,1730,1870,1250,1095,982,1555,5140,1660,1670,4810,2300,1050,4670,3500,2700,2370,3650,910,3100,550,2500,3885,970,1380,2395,1300,1550,7075,4030,1270,1100,820,5505,2400,2390,1130,3250,3470,1790,1850,3400,980,3198,3225,5060,5380,4000,2780,360,4050,1510,3052,3800,525,1609,1510,6840,4140,3415,3350,8600,3560,7890,4660,1540,2215,2710,1550,715,3745,2415,3880,3650,2760,4895,4075,2825,575,4095,1895,2509,232,1135,1419,6120,1930,3995,1580,6105,3025,3340,1360,4190,2440,1655,1460,5210,5300,1410,3050,2550,1260,1550,400,2675,1680,3600,2760,1700,1310,3675,1270,3100,7350,1270,1363,1676,5380,2610,5800,2300,485,800,3960,4200,1775,550,1515,3145,900,2770,800,1070,1750,1530,652,880,1070,2670,4060,1490,1650,3620,4130,3501,750,4615,7440,2950,3827,1325,2200,4600,1500,100,1070,2330,800,1599,1400,2200,980,2500,540,2501,2135,892,1200,2120,2970,2945,2188,3350,5980,1615,3300,1673,1637,3710,4570,4890,2450,2880,1900,1805,265,916,2360,2400,1100,2830,1220,5420,1370,2430,3800,250,7020,3659,8930,300,1150,1119,900,1300,1900,5370,4950,720,1680,3301,1620,1400,1530,400,500,1805,2710,1805,1910,4225,2810,660,4600,900,1600,2150,2050,2355,950,2225,1925,4065,2365,1930,5065,4700,150,999,1665,1410,4210,700,1250,620,1215,580,855,1980,3750,8050,780,3132,4830,6400,1590,1630,2700,3190,610,2045,1185,400,2420,3275,660,2090,2815,4098,5230,2210,4105,1610,1750,477,3100,1522,2863,6620,2600,5380,5200,3050,1615,4401,1165,530,1840,2270,1902,4750,2690,2150,1350,6425,1520,1060,1885,870,1470,1525,1020,300,800,5699,3505,3450,6110,3160,575,730,1850,1590,2950,4780,1150,3270,50,2835,1800,413,2550,305,1130,4335,1340,5700,1700,1850,1172,1900,2185,1500,7725,1375,7264,3907,2810,4575,3560,4866,2509,1290,5075,6175,1499,3120,3400,2580,965,485,1765,650,8820,7000,1710,2030,3085,410,374,1875,3510,2655,1095,1750,950,832,1125,1558,2220,1214,2320,2298,2445,2330,3900,1709,3220,1185,3160,250,1550,2800,890,2529,924,755,850,1660,2562,1680,2130,2644,1450,3470,310,419,1720,1182,1500,2350,910,5880,2600,2090,150,3070,5870,1250,3425,2055,900,150,2899,3030,1375,2752,970,932,2076,850,225]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>income<\/th>\n      <th>income_plus_error<\/th>\n      <th>clothing_expenditure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"scrollY":300,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r"), xlim=c(0, 100000))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-27-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

```r
xyplot(clothing_expenditure~income_plus_error, data=spending_subset,  type=c("p", "r"), xlim=c(0, 100000))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-28-1.png" width="504" style="display: block; margin: auto;" /&gt;


---

```r
msummary(lm(clothing_expenditure~income, data=spending_subset)) 
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.578e+03  1.864e+02   8.465 2.89e-16 ***
## income      2.116e-02  4.126e-03   5.129 4.17e-07 ***
## 
## Residual standard error: 1646 on 498 degrees of freedom
## Multiple R-squared:  0.05018,	Adjusted R-squared:  0.04827 
## F-statistic: 26.31 on 1 and 498 DF,  p-value: 4.174e-07
```

```r
msummary(lm(clothing_expenditure~income_plus_error, data=spending_subset))
```

```
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       1.733e+03  1.672e+02  10.364  &lt; 2e-16 ***
## income_plus_error 1.738e-02  3.603e-03   4.825 1.87e-06 ***
## 
## Residual standard error: 1651 on 498 degrees of freedom
## Multiple R-squared:  0.04465,	Adjusted R-squared:  0.04273 
## F-statistic: 23.28 on 1 and 498 DF,  p-value: 1.868e-06
```


---

```r
anova(lm(clothing_expenditure~income, data=spending_subset)) 
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##            Df     Sum Sq  Mean Sq F value    Pr(&gt;F)    
## income      1   71258930 71258930  26.309 4.174e-07 ***
## Residuals 498 1348849454  2708533                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
anova(lm(clothing_expenditure~income_plus_error, data=spending_subset))
```

```
## Analysis of Variance Table
## 
## Response: clothing_expenditure
##                    Df     Sum Sq  Mean Sq F value    Pr(&gt;F)    
## income_plus_error   1   63412296 63412296  23.277 1.868e-06 ***
## Residuals         498 1356696088  2724289                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```



---

.pull-left[
Introducing measurement error into `\(Y\)`

```r
X = 1:100
Y = X
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-31-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
## 
## for (i in 1:1000) { 
## Y = Y + rnorm(100)
## plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
## abline(lm(Y~X))
## lines(c(-10, 110), c(-10, 110), col="grey", lty=2)}
```
]

.pull-right[
Introducing measurement error into `\(X\)`

```r
X = 1:100
Y = X
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-32-1.png" width="504" style="display: block; margin: auto;" /&gt;

```r
## 
## for (i in 1:1000) { 
## X = X + rnorm(100)
## plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
## abline(lm(Y~X))
## lines(c(-10, 110), c(-10, 110), col="grey", lty=2)}
```
]

---



.pull-left[
Introducing measurement error into `\(Y\)`

```r
X = 1:100
Y = X
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
```

```r
for (i in 1:5000) { 
Y = Y + rnorm(100)
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
abline(lm(Y~X), lwd=2)
lines(c(-10, 110), c(-10, 110), col="grey", lty=2, lwd=2)}
```

&lt;img src="chapter4_files/figure-html/measurement_error_Y.gif" width="504" style="display: block; margin: auto;" /&gt;
]

.pull-right[
Introducing measurement error into `\(X\)`

```r
X = 1:100
Y = X
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
```

```r
for (i in 1:5000) { 
X = X + rnorm(100)
plot(X, Y, ylim=c(-10, 110), xlim=c(-10, 110))
abline(lm(Y~X), lwd=2)
lines(c(-10, 110), c(-10, 110), col="grey", lty=2, lwd=2)}
```

&lt;img src="chapter4_files/figure-html/measurement_error_X.gif" width="504" style="display: block; margin: auto;" /&gt;
]

---
layout: false

### Classical Measurement Error

The regression model that we would like to study is
$$ Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i$$

However, we observe only `\(X_i^\ast = X + \delta_i\)`, so we actually study `\(Y_i = \beta_0^\ast + \beta_1^\ast X_i^\ast + \varepsilon_i^\ast\)`  
--

Even if `\(E[X_i^\ast] = X_i\)`, we will not get the same estimates from these models. 

--

Notice that 
`$$\begin{align*} Y_i &amp;= \beta_0 + \beta_1 X_i + \varepsilon_i \\ &amp;= \beta_0 + \beta_1 (X_i^\ast - \delta) + \varepsilon_i \\ &amp;= \beta_0 + \beta_1 X_i^\ast + (\varepsilon_i  - \beta_1 \delta) \end{align*}$$`
isn't an ordinary regression model because `\(X_i^\ast\)` and `\(\delta\)` are correlated. 

This leads to an *attenuation* of the parameter estimate.
In fact, we can show that 
`$$\beta_1^\ast = \beta_1 \frac{\sigma_X^2}{\sigma_X^2 + \sigma_\delta^2}$$`

---
layout: true
class: inverse
---




```r
msummary(lm(clothing_expenditure~income, data=spending_subset)) 
```

```
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.578e+03  1.864e+02   8.465 2.89e-16 ***
## income      2.116e-02  4.126e-03   5.129 4.17e-07 ***
## 
## Residual standard error: 1646 on 498 degrees of freedom
## Multiple R-squared:  0.05018,	Adjusted R-squared:  0.04827 
## F-statistic: 26.31 on 1 and 498 DF,  p-value: 4.174e-07
```

```r
msummary(lm(clothing_expenditure~income_plus_error, data=spending_subset))
```

```
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       1.733e+03  1.672e+02  10.364  &lt; 2e-16 ***
## income_plus_error 1.738e-02  3.603e-03   4.825 1.87e-06 ***
## 
## Residual standard error: 1651 on 498 degrees of freedom
## Multiple R-squared:  0.04465,	Adjusted R-squared:  0.04273 
## F-statistic: 23.28 on 1 and 498 DF,  p-value: 1.868e-06
```

`$$\begin{align*} \beta_1^\ast &amp;= \beta_1 \frac{\sigma_X^2}{\sigma_X^2 + \sigma_\delta^2} \\ &amp;= \beta_1 \frac{\sigma_X^2}{\sigma_X^2 + \sigma_X^2/4} \\ &amp;= \beta_1 (.8) \end{align*}$$`

---


* **If it was discovered that income was measured with error, how would that impact your interpretation of the regression output given above? **

&lt;!-- PUT SELECT WARM UP RESPONSES HEREHERE (preceded by a "&gt;"): --&gt;
&lt;!-- warm up question 4) 3 --&gt;


---

layout: false

### 4.7: Choice of `\(X\)` Levels

Consider the impact of the choice of `\(X\)` levels:

&lt;img src="img/Figure171.png" width="60%" style="display: block; margin: auto;" /&gt;

---


Although the number and spacing of `\(X\)` levels depends very much on the major purpose of the regression analysis, the general advice given by D. R. Cox is still relevant:

&gt; Use two levels when the object is primarily to examine whether or not ... (the predictor variable) . . . has an effect and in which direction that effect is. 

&gt; Use three levels whenever a description of the response curve by its slope and curvature is likely to be adequate; this should cover most cases. 

&gt; Use four levels if further examination of the shape of the response curve is important. 

&gt; Use more than four levels when it is required to estimate the detailed shape of the response curve, or when the curve is expected to rise to an asymptotic value, or in general to show features not adequately described by slope and curvature. Except in these last cases it is generally satisfactory to use equally spaced levels with equal numbers of observations per level.

---

layout: true
class: inverse

---
### SHS: Choice of `\(X\)` Levels

Income and Clothing Expenditure for a small subset of the Survey of Household Spending are displayed below:


```r
xyplot(clothing_expenditure~income, data=spending_subset,  type=c("p", "r"))
```

&lt;img src="chapter4_files/figure-html/unnamed-chunk-37-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

* ** If you could design an experiment where you controlled the values of income, how could that change your regression findings?  **

&lt;!-- PUT SELECT WARM UP RESPONSES HEREHERE (preceded by a "&gt;"): --&gt;
&lt;!-- warm up question 4) 4 --&gt;





---
layout: false

### Recap: Sections 4.5, 4.7 

After Sections 4.5 and 4.7, you should be able to 

- Understand the potential impact of measurement error
- Understand the challenges of choosing `\(X\)` levels when designing an experiment


---

### Examples of Measurement Error: 

*  Lester F, Arbuckle TE, Peng P, and McIsaac MA (2018). Impact of exposure to phenols during early pregnancy on birth weight in two Canadian Cohort studies subject to measurement errors. *Environment International*, 120, 231-237.

* Addressing measurement error in a cumulative exposure variable: the relationship between light
at night and breast cancer risk
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
